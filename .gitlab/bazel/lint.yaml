bazel:mod-deps:
  allow_failure: true  #incident-46079
  extends: .bazel:runner:linux-amd64
  stage: lint
  script:
    - bazel mod deps --lockfile_mode=error
  after_script:
    - |-
      if [ $CI_JOB_STATUS = failed ]; then
        echo >&2 "ğŸ’¡ bazel mod deps"
        bazel mod deps
        git diff
      fi

bazel:run-buildifier-test:
  extends: .bazel:runner:linux-amd64
  stage: lint
  script:
    - bazel run //bazel/buildifier:test
  after_script:
    - |-
      if [ $CI_JOB_STATUS = failed ]; then
        echo >&2 "ğŸ’¡ bazel run //bazel/buildifier"
      fi
