---
.upload_junit_source:
  - $CI_PROJECT_DIR/tools/ci/junit_upload.sh

.upload_coverage:
  # Upload coverage files to Codecov. Fail fast unless coverage output was not created due to an earlier error.
  - CODECOV_TOKEN=$($CI_PROJECT_DIR/tools/ci/fetch_secret.sh $CODECOV token) || exit $?; export CODECOV_TOKEN
  - dda inv -- -e coverage.upload-to-codecov $COVERAGE_CACHE_FLAG

.unit_test_base:
  variables:
    FLAKY_PATTERNS_CONFIG: $CI_PROJECT_DIR/flaky-patterns-runtime.yaml
