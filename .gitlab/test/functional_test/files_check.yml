files_check:
  stage: functional_test
  rules:
    - !reference [.except_coverage_pipeline] # Coverage pipeline creates a special artifact that will not pass the quality gate
    - !reference [.on_main_or_release_branch]
    - !reference [.on_dev_branches]
    - when: on_success
  image: registry.ddbuild.io/ci/datadog-agent-buildimages/linux$CI_IMAGE_LINUX_SUFFIX:$CI_IMAGE_LINUX
  tags: ["arch:amd64", "specific:true"]
  needs:
    - agent_deb-x64-a7
  script:
    - dda inv -- quality-gates.check-files ${CI_COMMIT_BRANCH} ${OMNIBUS_PACKAGE_DIR}
  artifacts:
    expire_in: 2 weeks
    paths:
      - "**/*_size_report_*.yml"


