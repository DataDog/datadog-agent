exporters:
    otlphttp:
        headers:
            dd-api-key: test-api-key
processors:
    filter/dd-hp-drop-internal:
        metrics:
            exclude:
                match_type: regexp
                metric_names:
                    - ^scrape_.*$
                    - ^up$
                    - ^promhttp_metric_handler_errors_total$
    infraattributes/default:
        allow_hostname_override: true
    resource/dd-profiler-internal-metadata:
        attributes:
            - action: upsert
              key: profiler_name
              value: full-host-profiler
            - action: upsert
              key: profiler_version
              value: 7.0.0-test
receivers:
    hostprofiler:
        symbol_uploader:
            enabled: true
            symbol_endpoints:
                - api_key: test_api_key_123
                  site: datadoghq.com
    prometheus/dd-hp-internal:
        config:
            scrape_configs:
                - fallback_scrape_protocol: PrometheusText0.0.4
                  job_name: host-profiler-internal
                  metric_name_escaping_scheme: underscores
                  metric_name_validation_scheme: legacy
                  scrape_interval: 60s
                  scrape_protocols:
                    - PrometheusText0.0.4
                  static_configs:
                    - targets:
                        - 0.0.0.0:8888
service:
    pipelines:
        profiles:
            exporters:
                - otlphttp
            processors:
                - batch
                - infraattributes/default
                - resource/dd-profiler-internal-metadata
            receivers:
                - hostprofiler
