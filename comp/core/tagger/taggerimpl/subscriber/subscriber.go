// Unless explicitly stated otherwise all files in this repository are licensed
// under the Apache License Version 2.0.
// This product includes software developed at Datadog (https://www.datadoghq.com/).
// Copyright 2016-present Datadog, Inc.

// Package subscriber implements the functionality needed to subscribe to events
// generated by the Tagger component.
package subscriber

import (
	"github.com/DataDog/datadog-agent/comp/core/tagger/types"
)

const bufferSize = 1000

// Subscriber describes a component that subscribes to the tagger
// Subscriber implements types.Subscription
type Subscriber struct {
	filter  types.Filter
	id      string
	ch      chan []types.EntityEvent
	manager SubscriptionManager
}

// ID implements #types.Subscription.ID
func (s *Subscriber) ID() string {
	return s.id
}

// EventsChan implements #types.Subscription.EventsChan
func (s *Subscriber) EventsChan() chan []types.EntityEvent {
	return s.ch
}

// Unsubscribe implements #types.Subscription.Unsubscribe
func (s *Subscriber) Unsubscribe() {
	s.manager.Unsubscribe(s.ID())
}
