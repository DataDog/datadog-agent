exporters:
  datadog:
    api:
      key: "ggggg77777"
      site: "datadoghq.eu"

extensions:
  datadog/dd-autoconfigured:
    api:
      key: "ggggg77777"
      site: "datadoghq.eu"
  ddflare/dd-autoconfigured:
  health_check/dd-autoconfigured:
  pprof/dd-autoconfigured:
  zpages/dd-autoconfigured:
    endpoint: "localhost:55679"

processors:
  infraattributes/dd-autoconfigured:
  filter/drop-prometheus-internal-metrics/dd-autoconfigured:
    metrics:
      exclude:
        match_type: regexp
        metric_names:
          - ^scrape_.*$
          - ^up$
          - ^promhttp_metric_handler_errors_total$
receivers:
  prometheus/dd-autoconfigured:
    config:
      scrape_configs:
        - fallback_scrape_protocol: "PrometheusText0.0.4"
          job_name: "datadog-agent"
          metric_name_escaping_scheme: "underscores"
          metric_name_validation_scheme: "legacy"
          scrape_interval: "60s"
          scrape_protocols:
            - "PrometheusText0.0.4"
          static_configs:
            - targets:
                - "0.0.0.0:8888"

service:
  extensions:
    - pprof/dd-autoconfigured
    - zpages/dd-autoconfigured
    - health_check/dd-autoconfigured
    - ddflare/dd-autoconfigured
    - datadog/dd-autoconfigured
  pipelines:
    logs:
      receivers:
        - "otlp"
      processors:
        - "infraattributes/dd-autoconfigured"
      exporters:
        - "datadog"
    metrics:
      receivers:
        - "otlp"
        - "datadog/connector"
      processors:
        - "infraattributes/dd-autoconfigured"
      exporters:
        - "datadog"
    metrics/dd-autoconfigured/datadog:
      receivers:
        - "prometheus/dd-autoconfigured"
      processors:
        - "filter/drop-prometheus-internal-metrics/dd-autoconfigured"
      exporters:
        - "datadog"
    traces:
      receivers:
        - "otlp"
      processors:
        - "infraattributes/dd-autoconfigured"
      exporters:
        - "datadog/connector"
        - "datadog"
