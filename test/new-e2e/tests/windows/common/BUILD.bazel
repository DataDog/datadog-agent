load("@rules_go//go:def.bzl", "go_library")

go_library(
    name = "common",
    srcs = [
        "acl.go",
        "assert.go",
        "cert.go",
        "crashdump.go",
        "defender.go",
        "eventlog.go",
        "filesystem_snapshot.go",
        "hostinfo.go",
        "msi.go",
        "network.go",
        "policy.go",
        "procdump.go",
        "process.go",
        "product.go",
        "proxy.go",
        "registry.go",
        "service.go",
        "temp.go",
        "user.go",
        "utils.go",
        "version.go",
    ],
    embedsrcs = ["fixtures/get-acl-helpers.ps1"],
    importpath = "github.com/DataDog/datadog-agent/test/new-e2e/tests/windows/common",
    visibility = ["//visibility:public"],
    deps = [
        "//test/e2e-framework/testing/components",
        "//test/new-e2e/tests/windows/common/powershell",
        "@com_github_cenkalti_backoff_v5//:backoff",
        "@com_github_davecgh_go_spew//spew",
        "@com_github_stretchr_testify//assert",
        "@org_golang_x_crypto//ssh",
        "@org_golang_x_text//encoding/unicode",
    ],
)
