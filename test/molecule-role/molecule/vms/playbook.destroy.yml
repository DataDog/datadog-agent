---
- name: Destroy
  hosts: localhost
  connection: local
  gather_facts: false
  tasks:
    - include_tasks: ../common/destroy/existing-ec2-instances.yml
    - include_tasks: ../common/destroy/destroy-molecule-instances.yml
    # Not working on vms for some reason
    # - include_tasks: ../common/destroy/wait-for-instances-deletion-to-complete.yml
    # Using a wait for instead
    - name: Waiting for molecule destroy (3 minutes)
      wait_for:
        timeout: 360
    - include_tasks: ../common/destroy/delete-remote-keypair.yml
