---
- name: (Local) Restore instance config for connection
  when: ci_project_dir is undefined or ci_project_dir == ""
  copy:
    src: ".molecule-temp/{{ molecule_scenario_name }}/instance_config.yml"
    dest: "{{ molecule_instance_config }}"

- name: (CI) Restore instance config for connection
  when: ci_project_dir is defined and ci_project_dir != ""
  copy:
    src: "{{ci_project_dir}}/.molecule-temp/{{ molecule_scenario_name }}/instance_config.yml"
    dest: "{{ molecule_instance_config }}"

- name: "Debug Information A"
  debug:
    msg: "{{ molecule_scenario_name }}"

- name: "Debug Information B"
  debug:
    msg: "{{ molecule_instance_config }}"

- name: "Debug Information C"
  debug:
    msg: "{{ ci_project_dir }}"

- name: instance_config content get
  command: cat "{{ci_project_dir}}/.molecule-temp/{{ molecule_scenario_name }}/instance_config.yml"
  register: command_output

- name: "Debug Information D"
  debug:
    msg: "{{command_output.stdout}}"

- name: Wait (Instance Config Restore)
  pause:
    seconds: 30
