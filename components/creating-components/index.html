<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="The home of Datadog Agent developer documentation"><meta name=author content=Datadog><link href=https://datadoghq.dev/datadog-agent/components/creating-components/ rel=canonical><link href=../overview/ rel=prev><link href=../testing/ rel=next><link rel=icon href=../../assets/images/favicon.ico><meta name=generator content="mkdocs-1.5.3, mkdocs-material-9.5.18"><title>Creating a Component - Datadog Agent</title><link rel=stylesheet href=../../assets/stylesheets/main.66ac8b77.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../assets/css/custom.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/firacode@6.2.0/distr/fira_code.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><link href=../../assets/stylesheets/glightbox.min.css rel=stylesheet><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style><script src=../../assets/javascripts/glightbox.min.js></script></head> <body dir=ltr data-md-color-scheme=slate data-md-color-primary=custom data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#creating-a-component class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="Datadog Agent" class="md-header__button md-logo" aria-label="Datadog Agent" data-md-component=logo> <img src=../../assets/images/logo.svg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Datadog Agent </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Creating a Component </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=custom data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=custom data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg> </label> </form> <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/DataDog/datadog-agent title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 480 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg> </div> <div class=md-source__repository> datadog/datadog-agent </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../guidelines/contributing/ class=md-tabs__link> Guidelines </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../overview/ class=md-tabs__link> Components </a> </li> <li class=md-tabs__item> <a href=../../architecture/dogstatsd/internals/ class=md-tabs__link> Architecture </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="Datadog Agent" class="md-nav__button md-logo" aria-label="Datadog Agent" data-md-component=logo> <img src=../../assets/images/logo.svg alt=logo> </a> Datadog Agent </label> <div class=md-nav__source> <a href=https://github.com/DataDog/datadog-agent title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 480 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg> </div> <div class=md-source__repository> datadog/datadog-agent </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_1> <label class=md-nav__link for=__nav_1 id=__nav_1_label tabindex=0> <span class=md-ellipsis> Home </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_1_label aria-expanded=false> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> Home </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> About </span> </a> </li> <li class=md-nav__item> <a href=../../setup/ class=md-nav__link> <span class=md-ellipsis> Setup </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> <span class=md-ellipsis> Guidelines </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Guidelines </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../guidelines/contributing/ class=md-nav__link> <span class=md-ellipsis> Contributing </span> </a> </li> <li class=md-nav__item> <a href=../../guidelines/docs/ class=md-nav__link> <span class=md-ellipsis> Documentation </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3 checked> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex> <span class=md-ellipsis> Components </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=true> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Components </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../overview/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_2 checked> <label class=md-nav__link for=__nav_3_2 id=__nav_3_2_label tabindex> <span class=md-ellipsis> Components </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_2_label aria-expanded=true> <label class=md-nav__title for=__nav_3_2> <span class="md-nav__icon md-icon"></span> Components </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Creating components </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Creating components </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#file-hierarchy class=md-nav__link> <span class=md-ellipsis> File hierarchy </span> </a> <nav class=md-nav aria-label="File hierarchy"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#why-all-those-files class=md-nav__link> <span class=md-ellipsis> Why all those files ? </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#bootstrapping-components class=md-nav__link> <span class=md-ellipsis> Bootstrapping components </span> </a> <nav class=md-nav aria-label="Bootstrapping components"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#the-def-folder class=md-nav__link> <span class=md-ellipsis> The def folder </span> </a> </li> <li class=md-nav__item> <a href=#the-impl-folders class=md-nav__link> <span class=md-ellipsis> The impl folders </span> </a> </li> <li class=md-nav__item> <a href=#the-fx-folders class=md-nav__link> <span class=md-ellipsis> The fx folders </span> </a> <nav class=md-nav aria-label="The fx folders"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#fx-none class=md-nav__link> <span class=md-ellipsis> fx-none </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#the-mock-folder class=md-nav__link> <span class=md-ellipsis> The mock folder </span> </a> </li> <li class=md-nav__item> <a href=#go-module class=md-nav__link> <span class=md-ellipsis> Go module </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#final-state class=md-nav__link> <span class=md-ellipsis> Final state </span> </a> </li> <li class=md-nav__item> <a href=#general-consideration-about-designing-components class=md-nav__link> <span class=md-ellipsis> General consideration about designing components </span> </a> <nav class=md-nav aria-label="General consideration about designing components"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#documentation class=md-nav__link> <span class=md-ellipsis> Documentation </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../testing/ class=md-nav__link> <span class=md-ellipsis> Testing components </span> </a> </li> <li class=md-nav__item> <a href=../using-components/ class=md-nav__link> <span class=md-ellipsis> Using components </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3_3> <label class=md-nav__link for=__nav_3_3 id=__nav_3_3_label tabindex> <span class=md-ellipsis> Shared features from components </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3_3> <span class="md-nav__icon md-icon"></span> Shared features from components </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3_3_1> <label class=md-nav__link for=__nav_3_3_1 id=__nav_3_3_1_label tabindex=0> <span class=md-ellipsis> Features </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_3_3_1_label aria-expanded=false> <label class=md-nav__title for=__nav_3_3_1> <span class="md-nav__icon md-icon"></span> Features </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../shared_features/flares/ class=md-nav__link> <span class=md-ellipsis> Flare </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class=md-ellipsis> Architecture </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Architecture </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4_1> <label class=md-nav__link for=__nav_4_1 id=__nav_4_1_label tabindex=0> <span class=md-ellipsis> DogStatsD </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_1_label aria-expanded=false> <label class=md-nav__title for=__nav_4_1> <span class="md-nav__icon md-icon"></span> DogStatsD </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../architecture/dogstatsd/internals/ class=md-nav__link> <span class=md-ellipsis> Internals </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#file-hierarchy class=md-nav__link> <span class=md-ellipsis> File hierarchy </span> </a> <nav class=md-nav aria-label="File hierarchy"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#why-all-those-files class=md-nav__link> <span class=md-ellipsis> Why all those files ? </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#bootstrapping-components class=md-nav__link> <span class=md-ellipsis> Bootstrapping components </span> </a> <nav class=md-nav aria-label="Bootstrapping components"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#the-def-folder class=md-nav__link> <span class=md-ellipsis> The def folder </span> </a> </li> <li class=md-nav__item> <a href=#the-impl-folders class=md-nav__link> <span class=md-ellipsis> The impl folders </span> </a> </li> <li class=md-nav__item> <a href=#the-fx-folders class=md-nav__link> <span class=md-ellipsis> The fx folders </span> </a> <nav class=md-nav aria-label="The fx folders"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#fx-none class=md-nav__link> <span class=md-ellipsis> fx-none </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#the-mock-folder class=md-nav__link> <span class=md-ellipsis> The mock folder </span> </a> </li> <li class=md-nav__item> <a href=#go-module class=md-nav__link> <span class=md-ellipsis> Go module </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#final-state class=md-nav__link> <span class=md-ellipsis> Final state </span> </a> </li> <li class=md-nav__item> <a href=#general-consideration-about-designing-components class=md-nav__link> <span class=md-ellipsis> General consideration about designing components </span> </a> <nav class=md-nav aria-label="General consideration about designing components"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#documentation class=md-nav__link> <span class=md-ellipsis> Documentation </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/DataDog/datadog-agent/blob/main/docs/public/components/creating-components.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-2m10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1 2.1 2.1Z"/></svg> </a> <h1 id=creating-a-component>Creating a Component<a class=headerlink href=#creating-a-component title="Permanent link">&para;</a></h1> <p>This page explains how to create components in detail.</p> <p>This page uses the example of creating a compression component. This component compresses a payload before sending it to the Datadog backend.</p> <p>Since there are multiple ways to compress data, this component provides two implementations of the same interface:</p> <ul> <li>The <a href=https://en.wikipedia.org/wiki/Zstd>ZSTD</a> data compression algorithm</li> <li>The <a href=https://en.wikipedia.org/wiki/ZIP_(file_format)>ZIP</a> data compression algorithm</li> </ul> <p>A component contains multiple folders and Go packages. Developers split a component into packages to isolate the interface from the implementations and improve code sharing. Declaring the interface in a separate package from the implementation allows you to import the interface without importing all of the implementations.</p> <h2 id=file-hierarchy>File hierarchy<a class=headerlink href=#file-hierarchy title="Permanent link">&para;</a></h2> <p>All components are located in the <code>comp</code> folder at the top of the Agent repo.</p> <p>The file hierarchy is as follows:</p> <div class=highlight><pre><span></span><code>comp /
  &lt;bundle name&gt; /        &lt;-- Optional
    &lt;comp name&gt; /
      def /              &lt;-- The folder containing the component interface and ALL its public types.
      impl /             &lt;-- The only or primary implementation of the component.
      impl-&lt;alternate&gt; / &lt;-- An alternate implementation.
      impl-none /        &lt;-- Optional. A noop implementation.
      fx /               &lt;-- All fx related logic for the primary implementation, if any.
      fx-&lt;alternate&gt; /   &lt;-- All fx related logic for a specific implementation.
      mock /             &lt;-- The mock implementation of the component to ease testing.
</code></pre></div> <!-- TODO: where do we put the `optional.NoneOption` ? Into its own fx-none folder ? --> <p>To note:</p> <ul> <li>If your component has only one implementation, it should live in the <code>impl</code> folder.</li> <li>If your component has several implementations instead of a single implementation, you have multiple <code>impl-&lt;version&gt;</code> folders instead of an <code>impl</code> folder. For example, your compression component has <code>impl-zstd</code> and <code>impl-zip</code> folders, but not an <code>impl</code> folder.</li> <li>If your component needs to offer a dummy/empty version, it should live in the <code>impl-none</code> folder.</li> </ul> <h3 id=why-all-those-files>Why all those files ?<a class=headerlink href=#why-all-those-files title="Permanent link">&para;</a></h3> <p>This file hierarchy aims to solve a few problems:</p> <ul> <li>Component users should only interact with the <code>def</code> folders and never care about which implementation was loaded in the main function.</li> <li>Go module support: when you create a Go module, all sub folders are pulled into the module. Thus, you need different folders for each implementation, the definition, and fx. This way, an external repository can pull a specific implementation and definition without having to import everything else.</li> <li>You have one <code>fx</code> folder per implementation, to allow binaries to import/link against a single folder.</li> <li>A main function that imports a component should be able to select a specific implementation without compiling with the others. For example: the ZSTD library should not be included at compile time when the ZIP version is used.</li> </ul> <h2 id=bootstrapping-components>Bootstrapping components<a class=headerlink href=#bootstrapping-components title="Permanent link">&para;</a></h2> <p>You can use the <a href=../../setup/#preface>invoke</a> task <code>deva components.new-component comp/&lt;component&gt;</code> to generate a scaffold for your new component.</p> <p>Every public variable, function, struct, and interface of your component <strong>must</strong> be documented. Refer to the <a href=#documentation>Documentation</a> section below for details.</p> <h3 id=the-def-folder>The def folder<a class=headerlink href=#the-def-folder title="Permanent link">&para;</a></h3> <p>The <code>def</code> folder contains your interface and ALL public types needed by the users of your component.</p> <p>In the example of a compression component, the def folder looks like this:</p> <div class="tabbed-set tabbed-alternate" data-tabs=1:1><input checked=checked id=the-def-folder-compcompressiondefcomponentgo name=__tabbed_1 type=radio><div class=tabbed-labels><label for=the-def-folder-compcompressiondefcomponentgo><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 16 16"><path d="M4 1.75C4 .784 4.784 0 5.75 0h5.586c.464 0 .909.184 1.237.513l2.914 2.914c.329.328.513.773.513 1.237v8.586A1.75 1.75 0 0 1 14.25 15h-9a.75.75 0 0 1 0-1.5h9a.25.25 0 0 0 .25-.25V6h-2.75A1.75 1.75 0 0 1 10 4.25V1.5H5.75a.25.25 0 0 0-.25.25v2.5a.75.75 0 0 1-1.5 0Zm1.72 4.97a.75.75 0 0 1 1.06 0l2 2a.75.75 0 0 1 0 1.06l-2 2a.749.749 0 0 1-1.275-.326.749.749 0 0 1 .215-.734l1.47-1.47-1.47-1.47a.75.75 0 0 1 0-1.06ZM3.28 7.78 1.81 9.25l1.47 1.47a.751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018l-2-2a.75.75 0 0 1 0-1.06l2-2a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042Zm8.22-6.218V4.25c0 .138.112.25.25.25h2.688l-.011-.013-2.914-2.914-.013-.011Z"/></svg></span> comp/compression/def/component.go</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><pre><span></span><code><span class=c1>// Package compression contains all public type and interfaces for the compression component</span>
<span class=kn>package</span><span class=w> </span><span class=nx>compression</span>

<span class=c1>// team: &lt;your team&gt;</span>

<span class=c1>// Component describes the interface implemented by all compression implementations.</span>
<span class=kd>type</span><span class=w> </span><span class=nx>Component</span><span class=w> </span><span class=kd>interface</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=c1>// Compress compresses the input data.</span>
<span class=w>    </span><span class=nx>Compress</span><span class=p>([]</span><span class=kt>byte</span><span class=p>)</span><span class=w> </span><span class=p>([]</span><span class=kt>byte</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span>

<span class=w>    </span><span class=c1>// Decompress decompresses the input data.</span>
<span class=w>    </span><span class=nx>Decompress</span><span class=p>([]</span><span class=kt>byte</span><span class=p>)</span><span class=w> </span><span class=p>([]</span><span class=kt>byte</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span>
<span class=p>}</span>
</code></pre></div> </div> </div> </div> <p>All component interfaces must be called <code>Component</code>, so all imports have the form <code>def.Component</code>.</p> <p>You can see that the interface only exposes the bare minimum. You should aim at having the smallest possible interface for your component.</p> <p>When defining a component interface, avoid using structs or interfaces from third-party dependencies.</p> <div class="admonition warning"> <p class=admonition-title>Interface using a third-party dependency</p> <div class=highlight><pre><span></span><code>package def

import &quot;github.com/prometheus/client_golang/prometheus&quot;

// team: agent-shared-components

// Component is the component type.
type Component interface {
    // RegisterCollector Registers a Collector with the prometheus registry
    RegisterCollector(c prometheus.Collector)
}
</code></pre></div> </div> <p>In the example above, every user of the <code>telemetry</code> component would have to import <code>github.com/prometheus/client_golang/prometheus</code> no matter which implementation they use.</p> <p>In general, be mindful of using external types in the public interface of your component. For example, it would make sense to use Docker types in a <code>docker</code> component, but not in a <code>container</code> component.</p> <!-- Also note that there is no `Start`/`Stop` method. Anything related to lifecycle will be handle
internally by each component (more on this [here TODO]()). --> <!-- TODO: write the lifecycle part and update the link above --> <h3 id=the-impl-folders>The impl folders<a class=headerlink href=#the-impl-folders title="Permanent link">&para;</a></h3> <p>The <code>impl</code> folder is where the component implementation is written. The details of component implementation are up to the developer. The only requirement is that there is a public instantiation function called <code>NewComponent</code>.</p> <div class="tabbed-set tabbed-alternate" data-tabs=2:1><input checked=checked id=the-impl-folders-compcompressionimpl-zstdcompressorgo name=__tabbed_2 type=radio><div class=tabbed-labels><label for=the-impl-folders-compcompressionimpl-zstdcompressorgo><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 16 16"><path d="M4 1.75C4 .784 4.784 0 5.75 0h5.586c.464 0 .909.184 1.237.513l2.914 2.914c.329.328.513.773.513 1.237v8.586A1.75 1.75 0 0 1 14.25 15h-9a.75.75 0 0 1 0-1.5h9a.25.25 0 0 0 .25-.25V6h-2.75A1.75 1.75 0 0 1 10 4.25V1.5H5.75a.25.25 0 0 0-.25.25v2.5a.75.75 0 0 1-1.5 0Zm1.72 4.97a.75.75 0 0 1 1.06 0l2 2a.75.75 0 0 1 0 1.06l-2 2a.749.749 0 0 1-1.275-.326.749.749 0 0 1 .215-.734l1.47-1.47-1.47-1.47a.75.75 0 0 1 0-1.06ZM3.28 7.78 1.81 9.25l1.47 1.47a.751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018l-2-2a.75.75 0 0 1 0-1.06l2-2a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042Zm8.22-6.218V4.25c0 .138.112.25.25.25h2.688l-.011-.013-2.914-2.914-.013-.011Z"/></svg></span> comp/compression/impl-zstd/compressor.go</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><pre><span></span><code><span class=kn>package</span><span class=w> </span><span class=nx>implzstd</span>

<span class=c1>// NewComponent returns a new ZSTD implementation for the compression component</span>
<span class=kd>func</span><span class=w> </span><span class=nx>NewComponent</span><span class=p>(</span><span class=nx>reqs</span><span class=w> </span><span class=nx>Requires</span><span class=p>)</span><span class=w> </span><span class=nx>Provides</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=o>...</span><span class=p>.</span>
<span class=p>}</span>
</code></pre></div> </div> </div> </div> <p>To require input arguments to the <code>NewComponent</code> instantiation function, use a special struct named <code>Requires</code>. The instantiation function returns a special stuct named <code>Provides</code>. This internal nomenclature is used to handle the different component dependencies using Fx groups.</p> <p>In this example, the compression component must access the configuration component and the log component. To express this, define a <code>Requires</code> struct with two fields. The name of the fields is irrelevant, but the type must be the concrete type of interface that you require.</p> <div class="tabbed-set tabbed-alternate" data-tabs=3:1><input checked=checked id=the-impl-folders-compcompressionimpl-zstdcompressorgo_1 name=__tabbed_3 type=radio><div class=tabbed-labels><label for=the-impl-folders-compcompressionimpl-zstdcompressorgo_1><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 16 16"><path d="M4 1.75C4 .784 4.784 0 5.75 0h5.586c.464 0 .909.184 1.237.513l2.914 2.914c.329.328.513.773.513 1.237v8.586A1.75 1.75 0 0 1 14.25 15h-9a.75.75 0 0 1 0-1.5h9a.25.25 0 0 0 .25-.25V6h-2.75A1.75 1.75 0 0 1 10 4.25V1.5H5.75a.25.25 0 0 0-.25.25v2.5a.75.75 0 0 1-1.5 0Zm1.72 4.97a.75.75 0 0 1 1.06 0l2 2a.75.75 0 0 1 0 1.06l-2 2a.749.749 0 0 1-1.275-.326.749.749 0 0 1 .215-.734l1.47-1.47-1.47-1.47a.75.75 0 0 1 0-1.06ZM3.28 7.78 1.81 9.25l1.47 1.47a.751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018l-2-2a.75.75 0 0 1 0-1.06l2-2a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042Zm8.22-6.218V4.25c0 .138.112.25.25.25h2.688l-.011-.013-2.914-2.914-.013-.011Z"/></svg></span> comp/compression/impl-zstd/compressor.go</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><pre><span></span><code><span class=kn>package</span><span class=w> </span><span class=nx>implzstd</span>

<span class=kn>import</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=s>&quot;fmt&quot;</span>

<span class=w>    </span><span class=nx>config</span><span class=w> </span><span class=s>&quot;github.com/DataDog/datadog-agent/comp/core/config/def&quot;</span>
<span class=w>    </span><span class=nx>log</span><span class=w> </span><span class=s>&quot;github.com/DataDog/datadog-agent/comp/core/log/def&quot;</span>
<span class=p>)</span>

<span class=c1>// Here, list all components and other types known by Fx that you need.</span>
<span class=c1>// To be used in `fx` folders, type and field need to be public.</span>
<span class=c1>//</span>
<span class=c1>// In this example, you need config and log components.</span>
<span class=kd>type</span><span class=w> </span><span class=nx>Requires</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>Conf</span><span class=w> </span><span class=nx>config</span><span class=p>.</span><span class=nx>Component</span>
<span class=w>    </span><span class=nx>Log</span><span class=w>  </span><span class=nx>log</span><span class=p>.</span><span class=nx>Component</span>
<span class=p>}</span>
</code></pre></div> </div> </div> </div> <div class="admonition info"> <p class=admonition-title>Using other components</p> <p>If you want to use another component within your own, add it to the <code>Requires</code> struct, and <code>Fx</code> will give it to you at initialization. Be careful of cycling dependencies.</p> </div> <p>For the output of the component, populate the <code>Provides</code> struct with the return values.</p> <div class="tabbed-set tabbed-alternate" data-tabs=4:1><input checked=checked id=the-impl-folders-compcompressionimpl-zstdcompressorgo_2 name=__tabbed_4 type=radio><div class=tabbed-labels><label for=the-impl-folders-compcompressionimpl-zstdcompressorgo_2><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 16 16"><path d="M4 1.75C4 .784 4.784 0 5.75 0h5.586c.464 0 .909.184 1.237.513l2.914 2.914c.329.328.513.773.513 1.237v8.586A1.75 1.75 0 0 1 14.25 15h-9a.75.75 0 0 1 0-1.5h9a.25.25 0 0 0 .25-.25V6h-2.75A1.75 1.75 0 0 1 10 4.25V1.5H5.75a.25.25 0 0 0-.25.25v2.5a.75.75 0 0 1-1.5 0Zm1.72 4.97a.75.75 0 0 1 1.06 0l2 2a.75.75 0 0 1 0 1.06l-2 2a.749.749 0 0 1-1.275-.326.749.749 0 0 1 .215-.734l1.47-1.47-1.47-1.47a.75.75 0 0 1 0-1.06ZM3.28 7.78 1.81 9.25l1.47 1.47a.751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018l-2-2a.75.75 0 0 1 0-1.06l2-2a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042Zm8.22-6.218V4.25c0 .138.112.25.25.25h2.688l-.011-.013-2.914-2.914-.013-.011Z"/></svg></span> comp/compression/impl-zstd/compressor.go</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><pre><span></span><code><span class=kn>package</span><span class=w> </span><span class=nx>implzstd</span>

<span class=kn>import</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=c1>// Always import the component def folder, so that you can return a &#39;compression.Component&#39; type.</span>
<span class=w>    </span><span class=nx>compression</span><span class=w> </span><span class=s>&quot;github.com/DataDog/datadog-agent/comp/compression/def&quot;</span>
<span class=p>)</span>

<span class=c1>// Here, list all the types your component is going to return. You can return as many types as you want; all of them are available through Fx in other components.</span>
<span class=c1>// To be used in `fx` folders, type and field need to be public.</span>
<span class=c1>//</span>
<span class=c1>// In this example, only the compression component is returned.</span>
<span class=kd>type</span><span class=w> </span><span class=nx>Provides</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>Comp</span><span class=w> </span><span class=nx>compression</span><span class=p>.</span><span class=nx>Component</span>
<span class=p>}</span>
</code></pre></div> </div> </div> </div> <p>All together, the component code looks like the following:</p> <div class="tabbed-set tabbed-alternate" data-tabs=5:1><input checked=checked id=the-impl-folders-compcompressionimpl-zstdcompressorgo_3 name=__tabbed_5 type=radio><div class=tabbed-labels><label for=the-impl-folders-compcompressionimpl-zstdcompressorgo_3><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 16 16"><path d="M4 1.75C4 .784 4.784 0 5.75 0h5.586c.464 0 .909.184 1.237.513l2.914 2.914c.329.328.513.773.513 1.237v8.586A1.75 1.75 0 0 1 14.25 15h-9a.75.75 0 0 1 0-1.5h9a.25.25 0 0 0 .25-.25V6h-2.75A1.75 1.75 0 0 1 10 4.25V1.5H5.75a.25.25 0 0 0-.25.25v2.5a.75.75 0 0 1-1.5 0Zm1.72 4.97a.75.75 0 0 1 1.06 0l2 2a.75.75 0 0 1 0 1.06l-2 2a.749.749 0 0 1-1.275-.326.749.749 0 0 1 .215-.734l1.47-1.47-1.47-1.47a.75.75 0 0 1 0-1.06ZM3.28 7.78 1.81 9.25l1.47 1.47a.751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018l-2-2a.75.75 0 0 1 0-1.06l2-2a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042Zm8.22-6.218V4.25c0 .138.112.25.25.25h2.688l-.011-.013-2.914-2.914-.013-.011Z"/></svg></span> comp/compression/impl-zstd/compressor.go</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><pre><span></span><code><span class=kn>package</span><span class=w> </span><span class=nx>implzstd</span>

<span class=kn>import</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=s>&quot;fmt&quot;</span>

<span class=w>    </span><span class=nx>compression</span><span class=w> </span><span class=s>&quot;github.com/DataDog/datadog-agent/comp/compression/def&quot;</span>
<span class=w>    </span><span class=nx>config</span><span class=w> </span><span class=s>&quot;github.com/DataDog/datadog-agent/comp/core/config/def&quot;</span>
<span class=w>    </span><span class=nx>log</span><span class=w> </span><span class=s>&quot;github.com/DataDog/datadog-agent/comp/core/log/def&quot;</span>
<span class=p>)</span>

<span class=kd>type</span><span class=w> </span><span class=nx>Requires</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>Conf</span><span class=w> </span><span class=nx>config</span><span class=p>.</span><span class=nx>Component</span>
<span class=w>    </span><span class=nx>Log</span><span class=w>  </span><span class=nx>log</span><span class=p>.</span><span class=nx>Component</span>
<span class=p>}</span>

<span class=kd>type</span><span class=w> </span><span class=nx>Provides</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>Comp</span><span class=w> </span><span class=nx>compression</span><span class=p>.</span><span class=nx>Component</span>
<span class=p>}</span>

<span class=c1>// The actual type implementing the &#39;Component&#39; interface. This type MUST be private, you need the guarantee that</span>
<span class=c1>// components can only be used through their respective interfaces.</span>
<span class=kd>type</span><span class=w> </span><span class=nx>compressor</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=c1>// Keep a ref on the config and log components, so that you can use them in the &#39;compressor&#39; methods</span>
<span class=w>    </span><span class=nx>conf</span><span class=w> </span><span class=nx>config</span><span class=p>.</span><span class=nx>Component</span>
<span class=w>    </span><span class=nx>log</span><span class=w>  </span><span class=nx>log</span><span class=p>.</span><span class=nx>Component</span>

<span class=w>    </span><span class=c1>// any other field you might need</span>
<span class=p>}</span>

<span class=c1>// NewComponent returns a new ZSTD implementation for the compression component</span>
<span class=kd>func</span><span class=w> </span><span class=nx>NewComponent</span><span class=p>(</span><span class=nx>reqs</span><span class=w> </span><span class=nx>Requires</span><span class=p>)</span><span class=w> </span><span class=nx>Provides</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=c1>// Here, do whatever is needed to build a ZSTD compression comp.</span>

<span class=w>    </span><span class=c1>// And create your component</span>
<span class=w>    </span><span class=nx>comp</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=o>&amp;</span><span class=nx>compressor</span><span class=p>{</span>
<span class=w>        </span><span class=nx>conf</span><span class=p>:</span><span class=w> </span><span class=nx>reqs</span><span class=p>.</span><span class=nx>Conf</span><span class=p>,</span>
<span class=w>        </span><span class=nx>log</span><span class=p>:</span><span class=w>  </span><span class=nx>reqs</span><span class=p>.</span><span class=nx>Log</span><span class=p>,</span>
<span class=w>    </span><span class=p>}</span>

<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>Provides</span><span class=p>{</span>
<span class=w>        </span><span class=nx>comp</span><span class=p>:</span><span class=w> </span><span class=nx>comp</span><span class=p>,</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>

<span class=c1>//</span>
<span class=c1>// You then need to implement all methods from your &#39;compression.Component&#39; interface</span>
<span class=c1>//</span>

<span class=c1>// Compress compresses the input data using ZSTD</span>
<span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>c</span><span class=w> </span><span class=o>*</span><span class=nx>compressor</span><span class=p>)</span><span class=w> </span><span class=nx>Compress</span><span class=p>(</span><span class=nx>data</span><span class=w> </span><span class=p>[]</span><span class=kt>byte</span><span class=p>)</span><span class=w> </span><span class=p>([]</span><span class=kt>byte</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>c</span><span class=p>.</span><span class=nx>log</span><span class=p>.</span><span class=nx>Debug</span><span class=p>(</span><span class=s>&quot;compressing a buffer with ZSTD&quot;</span><span class=p>)</span>

<span class=w>    </span><span class=c1>// [...]</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>compressData</span><span class=p>,</span><span class=w> </span><span class=kc>nil</span>
<span class=p>}</span>

<span class=c1>// Decompress decompresses the input data using ZSTD.</span>
<span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>c</span><span class=w> </span><span class=o>*</span><span class=nx>compressor</span><span class=p>)</span><span class=w> </span><span class=nx>Decompress</span><span class=p>(</span><span class=nx>data</span><span class=w> </span><span class=p>[]</span><span class=kt>byte</span><span class=p>)</span><span class=w> </span><span class=p>([]</span><span class=kt>byte</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>c</span><span class=p>.</span><span class=nx>log</span><span class=p>.</span><span class=nx>Debug</span><span class=p>(</span><span class=s>&quot;decompressing a buffer with ZSTD&quot;</span><span class=p>)</span>

<span class=w>    </span><span class=c1>// [...]</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>compressData</span><span class=p>,</span><span class=w> </span><span class=kc>nil</span>
<span class=p>}</span>
</code></pre></div> </div> </div> </div> <p>The constructor can return either a <code>Provides</code>, if it is infallible, or <code>(Provides, error)</code>, if it could fail. In the latter case, a non-nil error results in the Agent crashing at startup with a message containing the error.</p> <p>Each implementation follows the same pattern.</p> <h3 id=the-fx-folders>The fx folders<a class=headerlink href=#the-fx-folders title="Permanent link">&para;</a></h3> <p>The <code>fx</code> folder must be the only folder importing and referencing Fx. It's meant to be a simple wrapper. Its only goal is to allow dependency injection with Fx for your component.</p> <p>All <code>fx.go</code> files must define a <code>func Module() fxutil.Module</code> function. The helpers contained in <code>fxutil</code> handle all the logic. Most <code>fx/fx.go</code> file should look the same as this:</p> <div class="tabbed-set tabbed-alternate" data-tabs=6:1><input checked=checked id=the-fx-folders-compcompressionfx-zstdfxgo name=__tabbed_6 type=radio><div class=tabbed-labels><label for=the-fx-folders-compcompressionfx-zstdfxgo><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 16 16"><path d="M4 1.75C4 .784 4.784 0 5.75 0h5.586c.464 0 .909.184 1.237.513l2.914 2.914c.329.328.513.773.513 1.237v8.586A1.75 1.75 0 0 1 14.25 15h-9a.75.75 0 0 1 0-1.5h9a.25.25 0 0 0 .25-.25V6h-2.75A1.75 1.75 0 0 1 10 4.25V1.5H5.75a.25.25 0 0 0-.25.25v2.5a.75.75 0 0 1-1.5 0Zm1.72 4.97a.75.75 0 0 1 1.06 0l2 2a.75.75 0 0 1 0 1.06l-2 2a.749.749 0 0 1-1.275-.326.749.749 0 0 1 .215-.734l1.47-1.47-1.47-1.47a.75.75 0 0 1 0-1.06ZM3.28 7.78 1.81 9.25l1.47 1.47a.751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018l-2-2a.75.75 0 0 1 0-1.06l2-2a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042Zm8.22-6.218V4.25c0 .138.112.25.25.25h2.688l-.011-.013-2.914-2.914-.013-.011Z"/></svg></span> comp/compression/fx-zstd/fx.go</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><pre><span></span><code><span class=kn>package</span><span class=w> </span><span class=nx>fxzstd</span>

<span class=kn>import</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=s>&quot;github.com/DataDog/datadog-agent/pkg/util/fxutil&quot;</span>

<span class=w>    </span><span class=c1>// You must import the implementation you are exposing through FX</span>
<span class=w>    </span><span class=nx>implzstd</span><span class=w> </span><span class=s>&quot;github.com/DataDog/datadog-agent/comp/compression/impl-zstd&quot;</span>
<span class=p>)</span>

<span class=c1>// Module specifies the compression module.</span>
<span class=kd>func</span><span class=w> </span><span class=nx>Module</span><span class=p>()</span><span class=w> </span><span class=nx>fxutil</span><span class=p>.</span><span class=nx>Module</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>fxutil</span><span class=p>.</span><span class=nx>Component</span><span class=p>(</span>
<span class=w>        </span><span class=c1>// ProvideComponentConstructor will automatically detect the &#39;Requires&#39; and &#39;Provides&#39; structs</span>
<span class=w>        </span><span class=c1>// of your constructor function and map them to FX.</span>
<span class=w>        </span><span class=nx>fxutil</span><span class=p>.</span><span class=nx>ProvideComponentConstructor</span><span class=p>(</span>
<span class=w>            </span><span class=nx>implzstd</span><span class=p>.</span><span class=nx>NewComponent</span><span class=p>,</span>
<span class=w>        </span><span class=p>)</span>
<span class=w>    </span><span class=p>)</span>
<span class=p>}</span>
</code></pre></div> </div> </div> </div> <div class="admonition info"> <p class=admonition-title>Optional dependencies</p> <p>Creating a conversion function to <code>optional.Option</code> is done automatically by <code>ProvideComponentConstructor</code>. This means that you can depend on any <code>comp</code> as an <code>optional.Option[comp]</code> if needed.</p> <p>More on this in the <a href=../faq/#optional-component>FAQ</a>.</p> </div> <p>For the ZIP implementation, create the same file in <code>fx-zip</code> folder. In most cases, your component has a single implementation. If so, you have only one <code>impl</code> and <code>fx</code> folder.</p> <h4 id=fx-none><code>fx-none</code><a class=headerlink href=#fx-none title="Permanent link">&para;</a></h4> <p>Some parts of the codebase might have optional dependencies on your components (see <a href=../faq/#optional-component>FAQ</a>).</p> <p>If it's the case, you need to provide a fx wrapper called <code>fx-none</code> to avoid duplicating the use of <code>optional.NewNoneOption[def.Component]()</code> in all our binaries</p> <div class="tabbed-set tabbed-alternate" data-tabs=7:1><input checked=checked id=fx-none-compcompressionfx-nonefxgo name=__tabbed_7 type=radio><div class=tabbed-labels><label for=fx-none-compcompressionfx-nonefxgo><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 16 16"><path d="M4 1.75C4 .784 4.784 0 5.75 0h5.586c.464 0 .909.184 1.237.513l2.914 2.914c.329.328.513.773.513 1.237v8.586A1.75 1.75 0 0 1 14.25 15h-9a.75.75 0 0 1 0-1.5h9a.25.25 0 0 0 .25-.25V6h-2.75A1.75 1.75 0 0 1 10 4.25V1.5H5.75a.25.25 0 0 0-.25.25v2.5a.75.75 0 0 1-1.5 0Zm1.72 4.97a.75.75 0 0 1 1.06 0l2 2a.75.75 0 0 1 0 1.06l-2 2a.749.749 0 0 1-1.275-.326.749.749 0 0 1 .215-.734l1.47-1.47-1.47-1.47a.75.75 0 0 1 0-1.06ZM3.28 7.78 1.81 9.25l1.47 1.47a.751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018l-2-2a.75.75 0 0 1 0-1.06l2-2a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042Zm8.22-6.218V4.25c0 .138.112.25.25.25h2.688l-.011-.013-2.914-2.914-.013-.011Z"/></svg></span> comp/compression/fx-none/fx.go</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=nx>compression</span><span class=w> </span><span class=s>&quot;github.com/DataDog/datadog-agent/comp/compression/def&quot;</span>
<span class=p>)</span>

<span class=kd>func</span><span class=w> </span><span class=nx>Module</span><span class=p>()</span><span class=w> </span><span class=nx>fxutil</span><span class=p>.</span><span class=nx>Module</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>fxutil</span><span class=p>.</span><span class=nx>Component</span><span class=p>(</span>
<span class=w>        </span><span class=nx>fx</span><span class=p>.</span><span class=nx>Provide</span><span class=p>(</span><span class=kd>func</span><span class=p>()</span><span class=w> </span><span class=nx>optional</span><span class=p>.</span><span class=nx>Option</span><span class=p>[</span><span class=nx>compression</span><span class=p>.</span><span class=nx>Component</span><span class=p>]</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=k>return</span><span class=w> </span><span class=nx>optional</span><span class=p>.</span><span class=nx>NewNoneOption</span><span class=p>[</span><span class=nx>compression</span><span class=p>.</span><span class=nx>Component</span><span class=p>]()</span>
<span class=w>        </span><span class=p>}))</span>
<span class=p>}</span>
</code></pre></div> </div> </div> </div> <h3 id=the-mock-folder>The mock folder<a class=headerlink href=#the-mock-folder title="Permanent link">&para;</a></h3> <p>To support testing, components MUST provide a mock implementation (unless your component has no public method in its interface).</p> <p>Your mock must implement the <code>Component</code> interface of the <code>def</code> folder but can expose more methods if needed. All mock constructors must take a <code>*testing.T</code> as parameter.</p> <p>In the following example, your mock has no dependencies and returns the same string every time.</p> <div class="tabbed-set tabbed-alternate" data-tabs=8:1><input checked=checked id=the-mock-folder-compcompressionmockmockgo name=__tabbed_8 type=radio><div class=tabbed-labels><label for=the-mock-folder-compcompressionmockmockgo><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 16 16"><path d="M4 1.75C4 .784 4.784 0 5.75 0h5.586c.464 0 .909.184 1.237.513l2.914 2.914c.329.328.513.773.513 1.237v8.586A1.75 1.75 0 0 1 14.25 15h-9a.75.75 0 0 1 0-1.5h9a.25.25 0 0 0 .25-.25V6h-2.75A1.75 1.75 0 0 1 10 4.25V1.5H5.75a.25.25 0 0 0-.25.25v2.5a.75.75 0 0 1-1.5 0Zm1.72 4.97a.75.75 0 0 1 1.06 0l2 2a.75.75 0 0 1 0 1.06l-2 2a.749.749 0 0 1-1.275-.326.749.749 0 0 1 .215-.734l1.47-1.47-1.47-1.47a.75.75 0 0 1 0-1.06ZM3.28 7.78 1.81 9.25l1.47 1.47a.751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018l-2-2a.75.75 0 0 1 0-1.06l2-2a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042Zm8.22-6.218V4.25c0 .138.112.25.25.25h2.688l-.011-.013-2.914-2.914-.013-.011Z"/></svg></span> comp/compression/mock/mock.go</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><pre><span></span><code><span class=c1>//go:build test</span>

<span class=kn>package</span><span class=w> </span><span class=nx>mock</span>

<span class=kn>import</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=s>&quot;testing&quot;</span>

<span class=w>    </span><span class=nx>compression</span><span class=w> </span><span class=s>&quot;github.com/DataDog/datadog-agent/comp/compression/def&quot;</span>
<span class=p>)</span>

<span class=kd>type</span><span class=w> </span><span class=nx>Provides</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>Comp</span><span class=w> </span><span class=nx>compression</span><span class=p>.</span><span class=nx>Component</span>
<span class=p>}</span>

<span class=kd>type</span><span class=w> </span><span class=nx>mock</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{}</span>

<span class=c1>// New returns a mock compressor</span>
<span class=kd>func</span><span class=w> </span><span class=nx>New</span><span class=p>(</span><span class=o>*</span><span class=nx>testing</span><span class=p>.</span><span class=nx>T</span><span class=p>)</span><span class=w> </span><span class=nx>Provides</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>Provides</span><span class=p>{</span>
<span class=w>        </span><span class=nx>comp</span><span class=p>:</span><span class=w> </span><span class=o>&amp;</span><span class=nx>mock</span><span class=p>{},</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>

<span class=c1>// Compress compresses the input data using ZSTD</span>
<span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>c</span><span class=w> </span><span class=o>*</span><span class=nx>mock</span><span class=p>)</span><span class=w> </span><span class=nx>Compress</span><span class=p>(</span><span class=nx>data</span><span class=w> </span><span class=p>[]</span><span class=kt>byte</span><span class=p>)</span><span class=w> </span><span class=p>([]</span><span class=kt>byte</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>[]</span><span class=nb>byte</span><span class=p>(</span><span class=s>&quot;compressed&quot;</span><span class=p>),</span><span class=w> </span><span class=kc>nil</span>
<span class=p>}</span>

<span class=c1>// Decompress decompresses the input data using ZSTD.</span>
<span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>c</span><span class=w> </span><span class=o>*</span><span class=nx>compressor</span><span class=p>)</span><span class=w> </span><span class=nx>Decompress</span><span class=p>(</span><span class=nx>data</span><span class=w> </span><span class=p>[]</span><span class=kt>byte</span><span class=p>)</span><span class=w> </span><span class=p>([]</span><span class=kt>byte</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>[]</span><span class=nb>byte</span><span class=p>(</span><span class=s>&quot;decompressed&quot;</span><span class=p>),</span><span class=w> </span><span class=kc>nil</span>
<span class=p>}</span>
</code></pre></div> </div> </div> </div> <h3 id=go-module>Go module<a class=headerlink href=#go-module title="Permanent link">&para;</a></h3> <p>Go modules are not mandatory, but if you want to allow your component to be used outside the <code>datadog-agent</code> repository, create Go modules in the following places:</p> <ul> <li>In the <code>impl</code>/<code>impl-*</code> folder that you want to expose (you can only expose some implementations).</li> <li>In the <code>def</code> folder to expose the interface</li> <li>In the <code>mock</code> folder to expose the mock</li> </ul> <p>Never add a Go module to the component folder (for example,<code>comp/compression</code>) or any <code>fx</code> folders.</p> <h2 id=final-state>Final state<a class=headerlink href=#final-state title="Permanent link">&para;</a></h2> <p>In the end, a classic component folder should look like:</p> <div class=highlight><pre><span></span><code>comp/&lt;component&gt;/
├── def
│   └── component.go
├── fx
│   └── fx.go
├── impl
│   └── component.go
└── mock
    └── mock.go

4 directories, 4 files
</code></pre></div> <p>The example compression component, which has two implementations, looks like:</p> <div class=highlight><pre><span></span><code>comp/core/compression/
├── def
│   └── component.go
├── fx-zip
│   └── fx.go
├── fx-zstd
│   └── fx.go
├── impl-zip
│   └── component.go
├── impl-zstd
│   └── component.go
└── mock
    └── mock.go

6 directories, 6 files
</code></pre></div> <p>This can seem like a lot for a single compression component, but this design answers the exponentially increasing complexity of the Agent ecosystem. Your component needs to behave correctly with many binaries composed of unique and shared components, outside repositories that want to pull only specific features, and everything in between.</p> <div class="admonition info"> <p class=admonition-title>Important</p> <p>No components know how or where they will be used and MUST, therefore, respect all the rules above. It's a very common pattern for teams to work only on their use cases, thinking their code will not be used anywhere else. But customers want common behavior between all Datadog products (Agent, serverless, Agentless, Helm, Operator, etc.).</p> <p>A key idea behind the component is to produce shareable and reusable code.</p> </div> <h2 id=general-consideration-about-designing-components>General consideration about designing components<a class=headerlink href=#general-consideration-about-designing-components title="Permanent link">&para;</a></h2> <p>Your component must:</p> <ul> <li>Be thread safe.</li> <li>Any public methods should be able to be used as soon as your constructor is called. It's OK if some do nothing or drop data as long as the Agent lifecycle is still in its init phase (see <a href>lifecycle section for more | TODO</a>).</li> <li>Be clearly documented (see section below).</li> <li>Be tested.</li> </ul> <h3 id=documentation>Documentation<a class=headerlink href=#documentation title="Permanent link">&para;</a></h3> <p>The documentation (both package-level and method-level) should include everything a user of the component needs to know. In particular, the documentation must address any assumptions that might lead to panic if violated by the user.</p> <p>Detailed documentation of how to avoid bugs in using a component is an indicator of excessive complexity and should be treated as a bug. Simplifying the usage will improve the robustness of the Agent.</p> <p>Documentation should include:</p> <ul> <li>Precise information on when each method may be called. Can methods be called concurrently?</li> <li> <p>Precise information about data ownership of passed values and returned values. Users can assume that any mutable value returned by a component will not be modified by the user or the component after it is returned. Similarly, any mutable value passed to a component will not be later modified, whether by the component or the caller. Any deviation from these defaults should be documented.</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>It can be surprisingly hard to avoid mutating data -- for example, <code>append(..)</code> surprisingly mutates its first argument. It is also hard to detect these bugs, as they are often intermittent, cause silent data corruption, or introduce rare data races. Where performance is not an issue, prefer to copy mutable input and outputs to avoid any potential bugs.</p> </div> </li> <li> <p>Precise information about goroutines and blocking. Users can assume that methods do not block indefinitely, so blocking methods should be documented as such. Methods that invoke callbacks should be clear about how the callback is invoked, and what it might do. For example, document whether the callback can block, and whether it might be called concurrently with other code.</p> </li> <li>Precise information about channels. Is the channel buffered? What happens if the channel is not read from quickly enough, or if reading stops? Can the channel be closed by the sender, and if so, what does that mean?</li> </ul> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title="Last update"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1-2.1-2M12.5 7v5.2l4 2.4-1 1L11 13V7h1.5M11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2v1.8Z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">May 30, 2024</span> </span> </aside> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../overview/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Overview"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> Overview </div> </div> </a> <a href=../testing/ class="md-footer__link md-footer__link--next" aria-label="Next: Testing components"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> Testing components </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; Datadog, Inc. 2024-present </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://www.datadoghq.com/blog/engineering/ target=_blank rel=noopener title=www.datadoghq.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M192 32c0 17.7 14.3 32 32 32 123.7 0 224 100.3 224 224 0 17.7 14.3 32 32 32s32-14.3 32-32C512 128.9 383.1 0 224 0c-17.7 0-32 14.3-32 32zm0 96c0 17.7 14.3 32 32 32 70.7 0 128 57.3 128 128 0 17.7 14.3 32 32 32s32-14.3 32-32c0-106-86-192-192-192-17.7 0-32 14.3-32 32zm-96 16c0-26.5-21.5-48-48-48S0 117.5 0 144v224c0 79.5 64.5 144 144 144s144-64.5 144-144-64.5-144-144-144h-16v96h16c26.5 0 48 21.5 48 48s-21.5 48-48 48-48-21.5-48-48V144z"/></svg> </a> <a href=https://github.com/DataDog target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 480 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg> </a> <a href=https://twitter.com/datadoghq target=_blank rel=noopener title=twitter.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg> </a> <a href=https://www.instagram.com/datadoghq target=_blank rel=noopener title=www.instagram.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["content.action.edit", "content.code.copy", "navigation.expand", "navigation.footer", "navigation.instant", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../../assets/javascripts/bundle.3220b9d7.min.js></script> <script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body> </html>