{
  "commands": [
    {
      "type": "running",
      "values": [
        "show running-config"
      ],
      "processing_rules": {
        "metadata": [
          {
            "type": "timestamp",
            "regex": "! Last configuration change at ([^\r\n]+)",
            "format": "15:04:05 MST Mon Jan 2 2006"
          },
          {
            "type": "config_size",
            "regex": "Current configuration : (?P<Size>\\d+)"
          }
        ],
        "validation": [
          {
            "type": "valid_output",
            "pattern": "Building configuration..."
          }
        ],
        "redaction": [
          {
            "regex": "(?m)^(snmp-server community).*",
            "replacement": "$1 <configuration removed>"
          },
          {
            "regex": "(?m)^(snmp-server host \\S+( vrf \\S+)?( informs?)?( version (1|2c))?) +\\S+( .*)?$",
            "replacement": "$1 <secret hidden>$6"
          },
          {
            "regex": "(?m)^(username .+ (password|secret) \\d) .+",
            "replacement": "$1 <secret hidden>"
          },
          {
            "regex": "(?m)^(enable (password|secret)( level \\d+)? \\d) .+",
            "replacement": "$1 <secret hidden>"
          },
          {
            "regex": "(?m)^( +(?:password|secret)) (?:\\d )?\\S+",
            "replacement": "$1 <secret hidden>"
          },
          {
            "regex": "(?m)^(.*wpa-psk ascii \\d) (\\S+)",
            "replacement": "$1 <secret hidden>"
          },
          {
            "regex": "(?m)^(.*key 7) (\\d.+)",
            "replacement": "$1 <secret hidden>"
          },
          {
            "regex": "(?m)^(tacacs-server (.+ )?key) .+",
            "replacement": "$1 <secret hidden>"
          },
          {
            "regex": "(?m)^(crypto isakmp key) (\\S+) (.*)",
            "replacement": "$1 <secret hidden> $3"
          },
          {
            "regex": "(?m)^( +ip ospf message-digest-key \\d+ md5) .+",
            "replacement": "$1 <secret hidden>"
          },
          {
            "regex": "(?m)^( +ip ospf authentication-key) .+",
            "replacement": "$1 <secret hidden>"
          },
          {
            "regex": "(?m)^( +neighbor \\S+ password) .+",
            "replacement": "$1 <secret hidden>"
          },
          {
            "regex": "(?m)^( +vrrp \\d+ authentication text) .+",
            "replacement": "$1 <secret hidden>"
          },
          {
            "regex": "(?m)^( +standby \\d+ authentication) .{1,8}$",
            "replacement": "$1 <secret hidden>"
          },
          {
            "regex": "(?m)^( +standby \\d+ authentication md5 key-string) .+?( timeout \\d+)?$",
            "replacement": "$1 <secret hidden> $2"
          },
          {
            "regex": "(?m)^( +key-string) .+",
            "replacement": "$1 <secret hidden>"
          },
          {
            "regex": "(?m)^((tacacs|radius) server [^\\n]+\\n( +[^\\n]+\\n)* +key) [^\\n]+$",
            "replacement": "$1 <secret hidden>"
          },
          {
            "regex": "(?m)^( +ppp (chap|pap) password \\d) .+",
            "replacement": "$1 <secret hidden>"
          },
          {
            "regex": "(?m)^( +security wpa psk set-key (?:ascii|hex) \\d) (.*)$",
            "replacement": "$1 <secret hidden>"
          },
          {
            "regex": "(?m)^( +dot1x username \\S+ password \\d) (.*)$",
            "replacement": "$1 <secret hidden>"
          },
          {
            "regex": "(?m)^( +mgmtuser username \\S+ password \\d) (.*) (secret \\d) (.*)$",
            "replacement": "$1 <secret hidden> $3 <secret hidden>"
          },
          {
            "regex": "(?m)^( +client \\S+ server-key \\d) (.*)$",
            "replacement": "$1 <secret hidden>"
          },
          {
            "regex": "(?m)^( +domain-password) \\S+ ?(.*)",
            "replacement": "$1 <secret hidden> $2"
          },
          {
            "regex": "(?m)^( +pre-shared-key).*",
            "replacement": "$1 <configuration removed>"
          },
          {
            "regex": "(?m)^(.*server-key(?: \\d)?) \\S+",
            "replacement": "$1 <secret hidden>"
          }
        ]
      }
    },
    {
      "type": "startup",
      "values": [
        "show startup-config"
      ],
      "processing_rules": {
        "metadata": [
          {
            "type": "timestamp",
            "regex": "! Last configuration change at ([^\r\n]+)",
            "format": "15:04:05 MST Mon Jan 2 2006"
          },
          {
            "type": "config_size",
            "regex": "Current configuration : (?P<Size>\\d+)"
          }
        ],
        "validation": [
          {
            "type": "valid_output",
            "pattern": "Building configuration..."
          }
        ],
        "redaction": [
          {
            "regex": "(?m)^(snmp-server community).*",
            "replacement": "$1 <configuration removed>"
          },
          {
            "regex": "(?m)^(snmp-server host \\S+( vrf \\S+)?( informs?)?( version (1|2c))?) +\\S+( .*)?$",
            "replacement": "$1 <secret hidden>$6"
          },
          {
            "regex": "(?m)^(username .+ (password|secret) \\d) .+",
            "replacement": "$1 <secret hidden>"
          },
          {
            "regex": "(?m)^(enable (password|secret)( level \\d+)? \\d) .+",
            "replacement": "$1 <secret hidden>"
          },
          {
            "regex": "(?m)^( +(?:password|secret)) (?:\\d )?\\S+",
            "replacement": "$1 <secret hidden>"
          },
          {
            "regex": "(?m)^(.*wpa-psk ascii \\d) (\\S+)",
            "replacement": "$1 <secret hidden>"
          },
          {
            "regex": "(?m)^(.*key 7) (\\d.+)",
            "replacement": "$1 <secret hidden>"
          },
          {
            "regex": "(?m)^(tacacs-server (.+ )?key) .+",
            "replacement": "$1 <secret hidden>"
          },
          {
            "regex": "(?m)^(crypto isakmp key) (\\S+) (.*)",
            "replacement": "$1 <secret hidden> $3"
          },
          {
            "regex": "(?m)^( +ip ospf message-digest-key \\d+ md5) .+",
            "replacement": "$1 <secret hidden>"
          },
          {
            "regex": "(?m)^( +ip ospf authentication-key) .+",
            "replacement": "$1 <secret hidden>"
          },
          {
            "regex": "(?m)^( +neighbor \\S+ password) .+",
            "replacement": "$1 <secret hidden>"
          },
          {
            "regex": "(?m)^( +vrrp \\d+ authentication text) .+",
            "replacement": "$1 <secret hidden>"
          },
          {
            "regex": "(?m)^( +standby \\d+ authentication) .{1,8}$",
            "replacement": "$1 <secret hidden>"
          },
          {
            "regex": "(?m)^( +standby \\d+ authentication md5 key-string) .+?( timeout \\d+)?$",
            "replacement": "$1 <secret hidden> $2"
          },
          {
            "regex": "(?m)^( +key-string) .+",
            "replacement": "$1 <secret hidden>"
          },
          {
            "regex": "(?m)^((tacacs|radius) server [^\\n]+\\n( +[^\\n]+\\n)* +key) [^\\n]+$",
            "replacement": "$1 <secret hidden>"
          },
          {
            "regex": "(?m)^( +ppp (chap|pap) password \\d) .+",
            "replacement": "$1 <secret hidden>"
          },
          {
            "regex": "(?m)^( +security wpa psk set-key (?:ascii|hex) \\d) (.*)$",
            "replacement": "$1 <secret hidden>"
          },
          {
            "regex": "(?m)^( +dot1x username \\S+ password \\d) (.*)$",
            "replacement": "$1 <secret hidden>"
          },
          {
            "regex": "(?m)^( +mgmtuser username \\S+ password \\d) (.*) (secret \\d) (.*)$",
            "replacement": "$1 <secret hidden> $3 <secret hidden>"
          },
          {
            "regex": "(?m)^( +client \\S+ server-key \\d) (.*)$",
            "replacement": "$1 <secret hidden>"
          },
          {
            "regex": "(?m)^( +domain-password) \\S+ ?(.*)",
            "replacement": "$1 <secret hidden> $2"
          },
          {
            "regex": "(?m)^( +pre-shared-key).*",
            "replacement": "$1 <configuration removed>"
          },
          {
            "regex": "(?m)^(.*server-key(?: \\d)?) \\S+",
            "replacement": "$1 <secret hidden>"
          }
        ]
      }
    },
    {
      "type": "version",
      "values": [
        "show version"
      ]
    }
  ]
}