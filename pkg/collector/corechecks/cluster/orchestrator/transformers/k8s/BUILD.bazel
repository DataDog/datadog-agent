load("@rules_go//go:def.bzl", "go_library", "go_test")

go_library(
    name = "k8s",
    srcs = [
        "clusterrole.go",
        "clusterrolebinding.go",
        "common.go",
        "cronjob_v1.go",
        "cronjob_v1beta1.go",
        "daemonset.go",
        "deployment.go",
        "horizontalpodautoscaler.go",
        "ingress.go",
        "job.go",
        "limitrange.go",
        "namespace.go",
        "networkpolicy.go",
        "node.go",
        "persistentvolume.go",
        "persistentvolumeclaim.go",
        "pod.go",
        "replicaset.go",
        "role.go",
        "rolebinding.go",
        "service.go",
        "serviceaccount.go",
        "statefulset.go",
        "storageclass.go",
        "verticalpodautoscaler.go",
    ],
    importpath = "github.com/DataDog/datadog-agent/pkg/collector/corechecks/cluster/orchestrator/transformers/k8s",
    visibility = ["//visibility:public"],
    deps = [
        "//pkg/collector/corechecks/cluster/orchestrator/transformers",
        "//pkg/util/kubernetes",
        "@com_github_datadog_agent_payload_v5//process",
        "@com_github_json_iterator_go//:go",
        "@com_github_twmb_murmur3//:murmur3",
        "@io_k8s_api//apps/v1:apps",
        "@io_k8s_api//autoscaling/v2:autoscaling",
        "@io_k8s_api//batch/v1:batch",
        "@io_k8s_api//batch/v1beta1",
        "@io_k8s_api//core/v1:core",
        "@io_k8s_api//networking/v1:networking",
        "@io_k8s_api//rbac/v1:rbac",
        "@io_k8s_api//storage/v1:storage",
        "@io_k8s_apimachinery//pkg/api/resource",
        "@io_k8s_apimachinery//pkg/apis/meta/v1:meta",
        "@io_k8s_apimachinery//pkg/util/sets",
        "@io_k8s_autoscaler_vertical_pod_autoscaler//pkg/apis/autoscaling.k8s.io/v1:autoscaling_k8s_io",
    ],
)

go_test(
    name = "k8s_test",
    srcs = [
        "clusterrole_test.go",
        "clusterrolebinding_test.go",
        "cronjob_v1_test.go",
        "cronjob_v1beta1_test.go",
        "daemonset_test.go",
        "deployment_test.go",
        "horizontalpodautoscaler_test.go",
        "ingress_test.go",
        "job_test.go",
        "limitrange_test.go",
        "namespace_test.go",
        "networkpolicy_test.go",
        "node_test.go",
        "persistentvolume_test.go",
        "persistentvolumeclaim_test.go",
        "pod_test.go",
        "replicaset_test.go",
        "role_test.go",
        "rolebinding_test.go",
        "service_test.go",
        "serviceaccount_test.go",
        "statefulset_test.go",
        "storageclass_test.go",
        "verticalpodautoscaler_test.go",
    ],
    embed = [":k8s"],
    deps = [
        "//pkg/util/kubernetes",
        "//pkg/util/pointer",
        "@com_github_datadog_agent_payload_v5//process",
        "@com_github_stretchr_testify//assert",
        "@io_k8s_api//apps/v1:apps",
        "@io_k8s_api//autoscaling/v1:autoscaling",
        "@io_k8s_api//autoscaling/v2:autoscaling",
        "@io_k8s_api//batch/v1:batch",
        "@io_k8s_api//batch/v1beta1",
        "@io_k8s_api//core/v1:core",
        "@io_k8s_api//networking/v1:networking",
        "@io_k8s_api//rbac/v1:rbac",
        "@io_k8s_api//storage/v1:storage",
        "@io_k8s_apimachinery//pkg/api/resource",
        "@io_k8s_apimachinery//pkg/apis/meta/v1:meta",
        "@io_k8s_apimachinery//pkg/types",
        "@io_k8s_apimachinery//pkg/util/intstr",
        "@io_k8s_autoscaler_vertical_pod_autoscaler//pkg/apis/autoscaling.k8s.io/v1:autoscaling_k8s_io",
    ],
)
