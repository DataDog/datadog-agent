load("@rules_pkg//pkg:install.bzl", "pkg_install")
load("@rules_pkg//pkg:mappings.bzl", "pkg_attributes", "pkg_files")

package(default_visibility = ["//packages:__subpackages__"])

pkg_files(
    name = "all_files",
    srcs = select({
        "@platforms//os:windows": ["powershell-script-config.yaml"],
        "//conditions:default": ["script-config.yaml"],
    }),
    attributes = pkg_attributes(
        group = "dd-agent",
        mode = "0400",
        owner = "dd-agent",
    ),
    prefix = select({
        "@platforms//os:windows": "ProgramData/Datadog/private-action-runner",
        "//conditions:default": "etc/datadog-agent/private-action-runner",
    }),
)

pkg_install(
    name = "install",
    srcs = [
        ":all_files",
    ],
)
