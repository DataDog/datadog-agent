{
  "commands": [
    {
      "type": "running",
      "values": [
        "show running-config"
      ],
      "processing_rules": {
        "validation": [
          {
            "type": "valid_output",
            "pattern": "(?i)Building Configuration"
          }
        ],
        "redaction": [
          {
            "regex": "(?m)^(secret) (\\S+)\\s?$",
            "replacement": "$1 <secret removed>"
          },
          {
            "regex": "(?m)^(enable secret) (\\S+)\\s?$",
            "replacement": "$1 <secret removed>"
          },
          {
            "regex": "(?mi)^(.*pre-share) (\\S+)\\s?$",
            "replacement": "$1 <secret removed>"
          },
          {
            "regex": "(?m)^(.*ipsec) (\\S+)\\s?$",
            "replacement": "$1 <secret removed>"
          },
          {
            "regex": "(?m)^(.*community) (\\S+)\\s?$",
            "replacement": "$1 <secret removed>"
          },
          {
            "regex": "( sha) (\\S+)",
            "replacement": "$1 <secret removed>"
          },
          {
            "regex": "( des) (\\S+)",
            "replacement": "$1 <secret removed>"
          },
          {
            "regex": "(?m)^(mobility-manager \\S+ user \\S+) (\\S+)",
            "replacement": "$1 <secret removed>"
          },
          {
            "regex": "(?m)^(mgmt-user \\S+ (?:root|guest-provisioning|network-operations|read-only|location-api-mgmt)) (\\S+)\\s?$",
            "replacement": "$1 <secret removed>"
          },
          {
            "regex": "(?m)^(mgmt-user \\S+) (\\S+)( (?:read-only|guest-mgmt))?\\s?$",
            "replacement": "$1 <secret removed> $3"
          },
          {
            "regex": "(?m)^(.*key) (\\S+)\\s?$",
            "replacement": "$1 <secret removed>"
          },
          {
            "regex": "(?m)^(vrrp-passphrase) (\\S+)\\s?$",
            "replacement": "$1 <secret removed>"
          },
          {
            "regex": "(?m)^(wpa-passphrase) (\\S+)\\s?$",
            "replacement": "$1 <secret removed>"
          },
          {
            "regex": "(?m)^(bkup-passwords) (\\S+)\\s?$",
            "replacement": "$1 <secret removed>"
          },
          {
            "regex": "(?m)^(ap-console-password) (\\S+)\\s?$",
            "replacement": "$1 <secret removed>"
          },
          {
            "regex": "(?m)^(virtual-controller-key) (\\S+)\\s?$",
            "replacement": "$1 <secret removed>"
          },
          {
            "regex": "community (.*?)\\s*$",
            "replacement": "community <secret removed>"
          },
          {
            "regex": "(?m)^(snmp-server host \\S+ (?:trap )?version (?:v?[123]c?|v3)) (\\S+)(.*)",
            "replacement": "$1 <secret removed>$3"
          },
          {
            "regex": "(?m)^(vrrp \\d+.*\\n.*\\n)(authentication) (\\S+)",
            "replacement": "$1$2 <secret removed>",
            "multiline": true
          },
          {
            "regex": "Building Configuration...\\s*",
            "replacement": "",
            "multiline": true
          }
        ]
      }
    },
    {
      "type": "version",
      "values": [
        "show version"
      ]
    }
  ]
}