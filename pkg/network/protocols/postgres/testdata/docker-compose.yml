version: '3.1'
name: postgres
services:
  postgres:
   image: postgres:15-alpine
   restart: always
   command: -c ssl=${ENCRYPTION_MODE} -c ssl_cert_file=/var/lib/postgresql/server.crt -c ssl_key_file=/var/lib/postgresql/server.key
   ports:
     - ${POSTGRES_ADDR:-127.0.0.1}:${POSTGRES_PORT:-5432}:5432
   environment:
     ENCRYPTION_MODE: ${ENCRYPTION_MODE:-off} 
     POSTGRES_USER: admin
     POSTGRES_PASSWORD: password
     POSTGRES_DB: testdb
   volumes:
     - ./server.crt:/var/lib/postgresql/server.crt
     - ./server.key:/var/lib/postgresql/server.key
