<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="The home of Datadog Agent developer documentation"><meta name=author content=Datadog><link href=https://datadoghq.dev/datadog-agent/how-to/build/distributions/ rel=canonical><link href=../standalone/ rel=prev><link href=../../test/unit/ rel=next><link rel=icon href=../../../assets/images/favicon.ico><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.22"><title>How to build agent distribution packages - Datadog Agent</title><link rel=stylesheet href=../../../assets/stylesheets/main.84d31ad4.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../../assets/css/custom.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/firacode@6.2.0/distr/fira_code.css><script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><link href=../../../assets/stylesheets/glightbox.min.css rel=stylesheet><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style><script src=../../../assets/javascripts/glightbox.min.js></script></head> <body dir=ltr data-md-color-scheme=slate data-md-color-primary=custom data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#how-to-build-agent-distribution-packages class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../.. title="Datadog Agent" class="md-header__button md-logo" aria-label="Datadog Agent" data-md-component=logo> <img src=../../../assets/images/logo.svg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Datadog Agent </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> How to build agent distribution packages </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=custom data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=custom data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/DataDog/datadog-agent title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M202.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M496 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg> </div> <div class=md-source__repository> datadog/datadog-agent </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../.. class=md-tabs__link> Home </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../standalone/ class=md-tabs__link> How-to </a> </li> <li class=md-tabs__item> <a href=../../../tutorials/dev/env/ class=md-tabs__link> Tutorials </a> </li> <li class=md-tabs__item> <a href=../../../guidelines/contributing/ class=md-tabs__link> Guidelines </a> </li> <li class=md-tabs__item> <a href=../../../components/overview/ class=md-tabs__link> Components </a> </li> <li class=md-tabs__item> <a href=../../../architecture/dogstatsd/internals/ class=md-tabs__link> Architecture </a> </li> <li class=md-tabs__item> <a href=../../../reference/images/dev/ class=md-tabs__link> Reference </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../.. title="Datadog Agent" class="md-nav__button md-logo" aria-label="Datadog Agent" data-md-component=logo> <img src=../../../assets/images/logo.svg alt=logo> </a> Datadog Agent </label> <div class=md-nav__source> <a href=https://github.com/DataDog/datadog-agent title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M202.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M496 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg> </div> <div class=md-source__repository> datadog/datadog-agent </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_1> <div class="md-nav__link md-nav__container"> <a href=../../.. class="md-nav__link "> <span class=md-ellipsis> Home </span> </a> <label class="md-nav__link " for=__nav_1 id=__nav_1_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_1_label aria-expanded=false> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> Home </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_1_2> <label class=md-nav__link for=__nav_1_2 id=__nav_1_2_label tabindex=0> <span class=md-ellipsis> Setup </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_1_2_label aria-expanded=false> <label class=md-nav__title for=__nav_1_2> <span class="md-nav__icon md-icon"></span> Setup </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../setup/required/ class=md-nav__link> <span class=md-ellipsis> Required </span> </a> </li> <li class=md-nav__item> <a href=../../../setup/optional/ class=md-nav__link> <span class=md-ellipsis> Optional </span> </a> </li> <li class=md-nav__item> <a href=../../../setup/manual/ class=md-nav__link> <span class=md-ellipsis> Manual </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2 checked> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex> <span class=md-ellipsis> How-to </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=true> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> How-to </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_1 checked> <label class=md-nav__link for=__nav_2_1 id=__nav_2_1_label tabindex> <span class=md-ellipsis> Build </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_1_label aria-expanded=true> <label class=md-nav__title for=__nav_2_1> <span class="md-nav__icon md-icon"></span> Build </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../standalone/ class=md-nav__link> <span class=md-ellipsis> Standalone agents </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Distribution packages </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Distribution packages </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#intro class=md-nav__link> <span class=md-ellipsis> Intro </span> </a> <nav class=md-nav aria-label=Intro> <ul class=md-nav__list> <li class=md-nav__item> <a href=#what-are-distribution-packages class=md-nav__link> <span class=md-ellipsis> What are distribution packages ? </span> </a> </li> <li class=md-nav__item> <a href=#omnibus class=md-nav__link> <span class=md-ellipsis> Omnibus </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#building-for-linux-deb class=md-nav__link> <span class=md-ellipsis> Building for Linux: deb </span> </a> <nav class=md-nav aria-label="Building for Linux: deb"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#using-the-dev-env class=md-nav__link> <span class=md-ellipsis> Using the dev env </span> </a> </li> <li class=md-nav__item> <a href=#using-the-build-image class=md-nav__link> <span class=md-ellipsis> Using the build image </span> </a> </li> <li class=md-nav__item> <a href=#building-on-the-host-discouraged class=md-nav__link> <span class=md-ellipsis> Building on the host (discouraged) </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#building-for-linux-rpm class=md-nav__link> <span class=md-ellipsis> Building for Linux: rpm </span> </a> </li> <li class=md-nav__item> <a href=#building-for-macos class=md-nav__link> <span class=md-ellipsis> Building for MacOS </span> </a> </li> <li class=md-nav__item> <a href=#building-for-windows class=md-nav__link> <span class=md-ellipsis> Building for Windows </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2_2> <label class=md-nav__link for=__nav_2_2 id=__nav_2_2_label tabindex> <span class=md-ellipsis> Test </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2> <span class="md-nav__icon md-icon"></span> Test </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../test/unit/ class=md-nav__link> <span class=md-ellipsis> Unit tests </span> </a> </li> <li class=md-nav__item> <a href=../../test/static-analysis/ class=md-nav__link> <span class=md-ellipsis> Static analysis </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2_3> <label class=md-nav__link for=__nav_2_3 id=__nav_2_3_label tabindex> <span class=md-ellipsis> Go </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_3_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3> <span class="md-nav__icon md-icon"></span> Go </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../go/modules/ class=md-nav__link> <span class=md-ellipsis> Add nested modules </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2_4> <div class="md-nav__link md-nav__container"> <a href=../../debug-agents/ class="md-nav__link "> <span class=md-ellipsis> Debug agents </span> </a> <label class="md-nav__link " for=__nav_2_4 id=__nav_2_4_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_4_label aria-expanded=false> <label class=md-nav__title for=__nav_2_4> <span class="md-nav__icon md-icon"></span> Debug agents </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../debug-agents/linux/ class=md-nav__link> <span class=md-ellipsis> Linux </span> </a> </li> <li class=md-nav__item> <a href=../../debug-agents/windows/ class=md-nav__link> <span class=md-ellipsis> Windows </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2_5> <label class=md-nav__link for=__nav_2_5 id=__nav_2_5_label tabindex> <span class=md-ellipsis> Memory profiling </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_5_label aria-expanded=false> <label class=md-nav__title for=__nav_2_5> <span class="md-nav__icon md-icon"></span> Memory profiling </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../memory-profiling/overview/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=../../memory-profiling/go/ class=md-nav__link> <span class=md-ellipsis> Go </span> </a> </li> <li class=md-nav__item> <a href=../../memory-profiling/python/ class=md-nav__link> <span class=md-ellipsis> Python </span> </a> </li> <li class=md-nav__item> <a href=../../memory-profiling/c%2B%2B/ class=md-nav__link> <span class=md-ellipsis> C++ </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> Tutorials </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Tutorials </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3_1> <label class=md-nav__link for=__nav_3_1 id=__nav_3_1_label tabindex=0> <span class=md-ellipsis> Develop </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_1_label aria-expanded=false> <label class=md-nav__title for=__nav_3_1> <span class="md-nav__icon md-icon"></span> Develop </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../tutorials/dev/env/ class=md-nav__link> <span class=md-ellipsis> Environment usage </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class=md-ellipsis> Guidelines </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Guidelines </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../guidelines/contributing/ class=md-nav__link> <span class=md-ellipsis> Contributing </span> </a> </li> <li class=md-nav__item> <a href=../../../guidelines/docs/ class=md-nav__link> <span class=md-ellipsis> Documentation </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4_3> <label class=md-nav__link for=__nav_4_3 id=__nav_4_3_label tabindex=0> <span class=md-ellipsis> Languages </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_3_label aria-expanded=false> <label class=md-nav__title for=__nav_4_3> <span class="md-nav__icon md-icon"></span> Languages </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../guidelines/languages/go/ class=md-nav__link> <span class=md-ellipsis> Go </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4_4> <label class=md-nav__link for=__nav_4_4 id=__nav_4_4_label tabindex=0> <span class=md-ellipsis> Testing </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4_4> <span class="md-nav__icon md-icon"></span> Testing </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../guidelines/testing/test-categories/ class=md-nav__link> <span class=md-ellipsis> Test categories </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4_5> <label class=md-nav__link for=__nav_4_5 id=__nav_4_5_label tabindex=0> <span class=md-ellipsis> Conventions </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_5_label aria-expanded=false> <label class=md-nav__title for=__nav_4_5> <span class="md-nav__icon md-icon"></span> Conventions </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../guidelines/conventions/logging/ class=md-nav__link> <span class=md-ellipsis> Logging </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> <span class=md-ellipsis> Components </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Components </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../components/overview/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5_2> <label class=md-nav__link for=__nav_5_2 id=__nav_5_2_label tabindex=0> <span class=md-ellipsis> Components </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_2_label aria-expanded=false> <label class=md-nav__title for=__nav_5_2> <span class="md-nav__icon md-icon"></span> Components </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../components/creating-components/ class=md-nav__link> <span class=md-ellipsis> Creating components </span> </a> </li> <li class=md-nav__item> <a href=../../../components/testing/ class=md-nav__link> <span class=md-ellipsis> Testing components </span> </a> </li> <li class=md-nav__item> <a href=../../../components/using-components/ class=md-nav__link> <span class=md-ellipsis> Using components </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5_3> <label class=md-nav__link for=__nav_5_3 id=__nav_5_3_label tabindex=0> <span class=md-ellipsis> Shared features from components </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_3_label aria-expanded=false> <label class=md-nav__title for=__nav_5_3> <span class="md-nav__icon md-icon"></span> Shared features from components </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5_3_1> <label class=md-nav__link for=__nav_5_3_1 id=__nav_5_3_1_label tabindex=0> <span class=md-ellipsis> Features </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_5_3_1_label aria-expanded=false> <label class=md-nav__title for=__nav_5_3_1> <span class="md-nav__icon md-icon"></span> Features </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../components/shared_features/flares/ class=md-nav__link> <span class=md-ellipsis> Flare </span> </a> </li> <li class=md-nav__item> <a href=../../../components/shared_features/status/ class=md-nav__link> <span class=md-ellipsis> Status </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0> <span class=md-ellipsis> Architecture </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Architecture </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_6_1> <label class=md-nav__link for=__nav_6_1 id=__nav_6_1_label tabindex=0> <span class=md-ellipsis> DogStatsD </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_6_1_label aria-expanded=false> <label class=md-nav__title for=__nav_6_1> <span class="md-nav__icon md-icon"></span> DogStatsD </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../architecture/dogstatsd/internals/ class=md-nav__link> <span class=md-ellipsis> Internals </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_7> <label class=md-nav__link for=__nav_7 id=__nav_7_label tabindex=0> <span class=md-ellipsis> Reference </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_7_label aria-expanded=false> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> Reference </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_7_1> <label class=md-nav__link for=__nav_7_1 id=__nav_7_1_label tabindex=0> <span class=md-ellipsis> Images </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_7_1_label aria-expanded=false> <label class=md-nav__title for=__nav_7_1> <span class="md-nav__icon md-icon"></span> Images </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../reference/images/dev/ class=md-nav__link> <span class=md-ellipsis> Developer environment </span> </a> </li> <li class=md-nav__item> <a href=../../../reference/images/builders/ class=md-nav__link> <span class=md-ellipsis> Builders </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_7_2> <label class=md-nav__link for=__nav_7_2 id=__nav_7_2_label tabindex=0> <span class=md-ellipsis> Agent buildables </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_7_2_label aria-expanded=false> <label class=md-nav__title for=__nav_7_2> <span class="md-nav__icon md-icon"></span> Agent buildables </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../reference/builds/components/ class=md-nav__link> <span class=md-ellipsis> Agent components </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#intro class=md-nav__link> <span class=md-ellipsis> Intro </span> </a> <nav class=md-nav aria-label=Intro> <ul class=md-nav__list> <li class=md-nav__item> <a href=#what-are-distribution-packages class=md-nav__link> <span class=md-ellipsis> What are distribution packages ? </span> </a> </li> <li class=md-nav__item> <a href=#omnibus class=md-nav__link> <span class=md-ellipsis> Omnibus </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#building-for-linux-deb class=md-nav__link> <span class=md-ellipsis> Building for Linux: deb </span> </a> <nav class=md-nav aria-label="Building for Linux: deb"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#using-the-dev-env class=md-nav__link> <span class=md-ellipsis> Using the dev env </span> </a> </li> <li class=md-nav__item> <a href=#using-the-build-image class=md-nav__link> <span class=md-ellipsis> Using the build image </span> </a> </li> <li class=md-nav__item> <a href=#building-on-the-host-discouraged class=md-nav__link> <span class=md-ellipsis> Building on the host (discouraged) </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#building-for-linux-rpm class=md-nav__link> <span class=md-ellipsis> Building for Linux: rpm </span> </a> </li> <li class=md-nav__item> <a href=#building-for-macos class=md-nav__link> <span class=md-ellipsis> Building for MacOS </span> </a> </li> <li class=md-nav__item> <a href=#building-for-windows class=md-nav__link> <span class=md-ellipsis> Building for Windows </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/DataDog/datadog-agent/blob/main/docs/public/how-to/build/distributions.md title="Edit this page" class="md-content__button md-icon" rel=edit> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg> </a> <h1 id=how-to-build-agent-distribution-packages>How to build agent distribution packages<a class=headerlink href=#how-to-build-agent-distribution-packages title="Permanent link">&para;</a></h1> <hr> <h2 id=intro>Intro<a class=headerlink href=#intro title="Permanent link">&para;</a></h2> <h3 id=what-are-distribution-packages>What are distribution packages ?<a class=headerlink href=#what-are-distribution-packages title="Permanent link">&para;</a></h3> <p>By "distribution package", we mean an artifact used by end users to install the Agent on their system. The format is OS-specific:</p> <table> <thead> <tr> <th>OS</th> <th>Package Format</th> </tr> </thead> <tbody> <tr> <td>Linux</td> <td><code>.deb</code> (Debian-based) / <code>.rpm</code> (RHEL-based)</td> </tr> <tr> <td>Windows</td> <td><code>.msi</code></td> </tr> <tr> <td>macOS</td> <td><code>.dmg</code></td> </tr> </tbody> </table> <p>These distribution packages contain <a href=../standalone/ >a binary of the Agent</a>, along with any supporting libraries needed for the agent to function properly.</p> <h3 id=omnibus>Omnibus<a class=headerlink href=#omnibus title="Permanent link">&para;</a></h3> <p>Agent packages for all the supported platforms are built using <a href=https://github.com/chef/omnibus>Omnibus</a>.</p> <div class="admonition info"> <p class=admonition-title>Info</p> <p>There is an ongoing effort to migrate our build system to <a href=https://bazel.build/ >Bazel</a>, so this may change in the near-to-mid future.</p> </div> <div class="admonition warning"> <p class=admonition-title>Warning</p> <p>Omnibus creates a package <strong>for the operating system it runs on</strong>, so you'll get a <code>.deb</code> package on Debian-based distros, an <code>msi</code> installer on Windows etc.</p> <p>There is currently no way to "cross-build" packages for a platform different than the host's.</p> </div> <p>Omnibus is best called indirectly, via <a href=../../../setup/required/#tooling>dda</a> commands. The main entrypoint is the <code>omnibus.build</code> invoke task, which you can run like this: <div class="language-bash highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a>dda<span class=w> </span>inv<span class=w> </span>omnibus.build
</span></code></pre></div></p> <blockquote> <p>This will probably not work out of the box though - see instructions below for more information.</p> </blockquote> <h2 id=building-for-linux-deb>Building for Linux: <code>deb</code><a class=headerlink href=#building-for-linux-deb title="Permanent link">&para;</a></h2> <h3 id=using-the-dev-env>Using the <code>dev env</code><a class=headerlink href=#using-the-dev-env title="Permanent link">&para;</a></h3> <p>The <a href=../../../reference/images/dev/ >developer environments</a> we provide contain all the dependencies required for building Omnibus packages, along with extra tools and features that make local development easier. We recommend that you use them for all your development needs.</p> <p>To build distribution packages in a developer environment:</p> <ol> <li>Follow the <a href=../../../tutorials/dev/env/ ><code>dev env</code> tutorial</a> to install the required tools and familiarize yourself with the dev environments.</li> <li>Make sure Docker is running on your system.</li> <li>Start a developer environment, which will automatically pull the latest version of the container image: <code>dda env dev start</code></li> <li> <p>Either:</p> <ul> <li>Connect to a shell inside the dev container: <code>dda env dev shell</code></li> <li>Open an IDE window inside the container: <code>dda env dev code</code></li> <li>Run a single command inside the container: prefix the command in the next step with <code>dda env dev run</code></li> </ul> </li> <li> <p>Run the following command: <div class="language-text highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a>dda inv -- -e omnibus.build
</span></code></pre></div></p> </li> </ol> <p>Once the process completes, the built artifacts will be available <em>in the container</em> under <code>/omnibus/pkg</code>.</p> <details class=tip> <summary>Moving the artifacts back to the host</summary> <p>The <code>datadog-agent</code> local repo clone is bind-mounted into the dev env container. You can use this to access your artifacts from the host, by copying them from <code>/omnibus/pkg</code> to <code>/root/repos/datadog-agent</code>: <div class="language-bash highlight"><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a>mv<span class=w> </span>/omnibus/pkg<span class=w> </span>/root/repos/datadog-agent/bin
</span></code></pre></div></p> </details> <h3 id=using-the-build-image>Using the build image<a class=headerlink href=#using-the-build-image title="Permanent link">&para;</a></h3> <p>We provide a <a href=../../../reference/images/builders/#linux>Docker image</a> containing all the build dependencies required for building <code>deb</code> packages via Omnibus: <a href=https://hub.docker.com/r/datadog/agent-buildimages-linux><code>datadog/agent-buildimages-linux</code></a>.This image is the one used by CI, and as such it is quite bare-bones. The developer environments mentioned in <a href=#using-the-dev-env>the section above</a> are based on this image.</p> <details class=tip> <summary>Building the image locally</summary> <p>The Dockerfile for this image is available in the <a href=https://github.com/DataDog/datadog-agent-buildimages>datadog-agent-buildimages</a> repository. To build it from scratch, you can run the following command from the root of that repo:</p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a>docker<span class=w> </span>build<span class=w> </span>-t<span class=w> </span>datadog-agent-buildimages:linux<span class=w> </span>-f<span class=w> </span>linux/Dockerfile<span class=w> </span>.
</span></code></pre></div> </details> <ol> <li>Make sure Docker is running on your machine.</li> <li>Navigate to the root folder of a clone of the <code>datadog-agent</code> repo.</li> <li>Run the following command, which will create a container for the previously-mentioned image, and run the <code>omnibus.build</code> task inside. <div class="language-bash highlight"><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a>docker<span class=w> </span>run
</span><span id=__span-4-2><a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a><span class=w>    </span>-v<span class=w> </span><span class=s2>&quot;</span><span class=nv>$PWD</span><span class=s2>:/go/src/github.com/DataDog/datadog-agent&quot;</span>
</span><span id=__span-4-3><a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a><span class=w>    </span>-v<span class=w> </span><span class=s2>&quot;/tmp/omnibus:/omnibus&quot;</span>
</span><span id=__span-4-4><a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a><span class=w>    </span>-v<span class=w> </span><span class=s2>&quot;/tmp/opt/datadog-agent:/opt/datadog-agent&quot;</span>
</span><span id=__span-4-5><a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a><span class=w>    </span>-v<span class=s2>&quot;/tmp/gems:/gems&quot;</span>
</span><span id=__span-4-6><a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a><span class=w>    </span>--workdir<span class=o>=</span>/go/src/github.com/DataDog/datadog-agent
</span><span id=__span-4-7><a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a><span class=w>    </span>datadog/agent-buildimages-linux
</span><span id=__span-4-8><a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a><span class=w>    </span>dda<span class=w> </span>inv<span class=w> </span>--<span class=w> </span>-e<span class=w> </span>omnibus.build<span class=w> </span>--base-dir<span class=o>=</span>/omnibus<span class=w> </span>--gem-path<span class=o>=</span>/gems
</span></code></pre></div></li> </ol> <div class="admonition info"> <p class=admonition-title>Info</p> <p>The container will bind-mount 3 volumes on the host to avoid starting from scratch at each Omnibus run:</p> <ul> <li><code>/tmp/omnibus</code>, containing the Omnibus base directory</li> <li><code>/tmp/opt/datadog-agent</code>, containing the Omnibus installation directory</li> <li><code>/tmp/gems</code>, containing all the ruby gems installed with Bundler</li> </ul> </div> <p>Once the process completes, the built artifacts will be available on your host under <code>/tmp/omnibus/pkg</code>.</p> <h3 id=building-on-the-host-discouraged>Building on the host (discouraged)<a class=headerlink href=#building-on-the-host-discouraged title="Permanent link">&para;</a></h3> <div class="admonition danger"> <p class=admonition-title>Danger</p> <p>Building on the host is <em>not recommended</em>, and this section of the guide will be maintained on a best-effort basis.</p> <p>Running Omnibus builds locally may affect the global state of your machine, and in particular the installation of the Agent already present on your laptop.</p> <p>Please use one of the <a href=#using-the-build-image>containerized build options</a> instead.</p> </div> <p>Running an Omnibus build will both create and install an Agent distribution package.</p> <ul> <li>The project will be built locally into a <code>.tar.xz</code> archive under <code>omnibus/pkg</code>.</li> <li>The project will be installed under <code>/opt/datadog-agent</code>. This is the same path where the Agent is installed on customer machines.</li> </ul> <div class="admonition warning"> <p class=admonition-title>Warning</p> <p>If you already have a Datadog Agent installed, you will need to move it to a different location before operating Omnibus - otherwise it will get overwritten by the build.</p> <blockquote> <p>As a Datadog employee, an Agent is installed on your machine during IT's onboarding session.</p> </blockquote> </div> <details> <summary>Linux-specific requirements</summary> <ul> <li>On Linux, you will need root privileges, as you need permission to write into <code>/opt</code></li> <li>On Linux, some configuration files will also be dropped under <code>/etc</code>.</li> </ul> </details> <ol> <li>Follow the <a href=../../../setup/manual/ >general local setup instructions</a></li> <li>Make <code>/opt</code> world-readable</li> <li>Run the following command: <div class="language-text highlight"><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a>dda inv -- omnibus.build --base-dir=$HOME/.omnibus
</span></code></pre></div></li> </ol> <p>The path you pass with the <code>--base-dir</code> option will be used as a working directory for the Omnibus build. Once the build completes, it will contain:</p> <table> <thead> <tr> <th>Directory</th> <th>Contents</th> </tr> </thead> <tbody> <tr> <td><code>src</code></td> <td>The sources downloaded by Omnibus</td> </tr> <tr> <td><code>cache</code></td> <td>The binaries cached after building those sources</td> </tr> <tr> <td><code>pkg</code></td> <td>The final <code>deb</code>/<code>rpm</code>/<code>dmg</code> artifacts</td> </tr> </tbody> </table> <details> <summary>Make sure to pass a <code>--base-dir</code> !</summary> <p>It is strongly advised to pass a <code>--base-dir</code>, and point it to a directory <strong>outside of the Agent repo.</strong></p> <p>By default Omnibus stores packages in the project folder itself: running the task multiple times would recursively add those artifacts to the source files for the <code>datadog-agent</code> software definition.</p> </details> <div class="admonition tip"> <p class=admonition-title>Tip</p> <p>You can fine tune an Omnibus run by passing more options, see <code>dda inv -- omnibus.build --help</code> for the list of all the available options.</p> <p>You can chose to generate an installable package in the form of a <code>deb</code>/<code>rpm</code> artifact by providing a <code>OMNIBUS_FORCE_PACKAGES</code> environment variable during the build.</p> <blockquote> <p>On macOS, a <code>dmg</code> artifact will always be generated.</p> </blockquote> </div> <h2 id=building-for-linux-rpm>Building for Linux: <code>rpm</code><a class=headerlink href=#building-for-linux-rpm title="Permanent link">&para;</a></h2> <p>Some extra dependencies are required for building <code>rpm</code> packages that are not yet included in the main <code>datadog/agent-buildimages-linux</code> build image.</p> <p>A separate docker image containing these special dependencies is also available. This image, contrary to the main <code>datadog/agent-buildimages-linux</code> image, is not multi-arch - thus there are two flavors depending on the CPU architecture of the host machine:</p> <ul> <li>For <code>x86_64</code>/<code>amd64</code>: <a href=https://hub.docker.com/r/datadog/agent-buildimages-rpm_x64><code>datadog/agent-buildimages-rpm_x64</code></a></li> <li>For <code>arm64</code>/<code>aarch64</code>: <a href=https://hub.docker.com/r/datadog/agent-buildimages-rpm_arm64><code>datadog/agent-buildimages-rpm_arm64</code></a></li> </ul> <p>To build using these images, follow the same instructions as <a href=#using-the-build-image>for <code>deb</code> packages</a>, but replace <code>datadog/agent-buildimages-linux</code> with the appropriate flavor of the <code>rpm</code> image for your CPU platform. You can also attempt a <a href=#building-on-the-host-discouraged>host-based build</a>, although this is heavily discouraged.</p> <h2 id=building-for-macos>Building for MacOS<a class=headerlink href=#building-for-macos title="Permanent link">&para;</a></h2> <p>We do not currently support MacOS development environments or any container build image. You will therefore need to follow the <a href=#building-on-the-host-discouraged>host-based build instructions</a>.</p> <p>When running the build command, you might want to skip the signing step by adding the <code>--skip-sign</code> flag.</p> <h2 id=building-for-windows>Building for Windows<a class=headerlink href=#building-for-windows title="Permanent link">&para;</a></h2> <div class="admonition warning"> <p class=admonition-title>Warning</p> <p>This can only be done in a containerized environment. Please see <a href=https://github.com/DataDog/datadog-agent-buildimages/tree/main/windows>the relevant folder in <code>datadog-agent-buildimages</code></a> for more details on the images to use.</p> <details class=info> <summary>Image naming scheme</summary> <p>As of the writing of this doc, the relevant images follow this naming pattern: <code>registry.ddbuild.io/datadog-agent-buildimages/windows_ltsc{$YEAR}_${ARCH}${SUFFIX}:${TAG}</code></p> <ul> <li><code>YEAR</code> is either <code>2022</code> or <code>2025</code></li> <li><code>ARCH</code> can only be <code>x64</code> at this time</li> <li><code>SUFFIX</code> can be either empty or <code>_test_only</code>, which refers to images used by CI in PR builds.</li> <li>The <code>TAG</code> follows the usual convention, i.e. <code>v{gitlab pipeline id}-{short commit sha}</code></li> </ul> <div class="admonition example"> <p class=admonition-title>Example</p> <p><code>registry.ddbuild.io/ci/datadog-agent-buildimages/windows_ltsc2025_x64:v77240728-510448c3</code></p> </div> </details> </div> <p>First, mount / clone a checkout of the <code>datadog-agent</code> repo inside the container.</p> <p>The recommended way to do this while developing manually is to bind-mount your host's checkout of the repo into the container.On the host, while inside the <code>datadog-agent</code> repo: <div class="language-powershell highlight"><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=n>docker</span> <span class=n>run</span> <span class=n>-v</span> <span class=s2>&quot;</span><span class=p>$(</span><span class=nb>Get-Location</span><span class=p>)</span><span class=s2>:c:\mnt&quot;</span> <span class=p>&lt;</span><span class=n>image</span><span class=p>&gt;</span>
</span></code></pre></div></p> <p>You can then invoke one of the windows build scripts, available in <code>tasks/winbuildscripts</code>:</p> <ul> <li><code>Build-AgentPackages.ps1</code> is used for building the "main" Agent msi package</li> <li><code>Build-OmnibusTarge.ps1</code> is used for building all other Agent packages via Omnibus</li> <li><code>Build-InstallerPackages.ps1</code> is used for building the <code>.exe</code> installer for the Agent.</li> </ul> <p>These scripts read a few environment variables, notably (non-exhaustive !):</p> <ul> <li><code>OMNIBUS_TARGET</code> - usually set to <code>main</code></li> <li><code>TARGET_ARCH</code> - only <code>x64</code> is supported at the moment</li> </ul> <div class="admonition example"> <p class=admonition-title>Example</p> <div class="language-powershell highlight"><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=n>docker</span> <span class=n>run</span> <span class=n>-v</span> <span class=s2>&quot;</span><span class=p>$(</span><span class=nb>Get-Location</span><span class=p>)</span><span class=s2>:c:\mnt&quot;</span> <span class=n>-e</span> <span class=n>OMNIBUS_TARGET</span><span class=p>=</span><span class=n>main</span> <span class=n>-e</span> <span class=n>TARGET_ARCH</span><span class=p>=</span><span class=n>x64</span> <span class=n>registry</span><span class=p>.</span><span class=n>ddbuild</span><span class=p>.</span><span class=n>io</span><span class=p>/</span><span class=n>ci</span><span class=p>/</span><span class=n>datadog-agent-buildimages</span><span class=p>/</span><span class=n>windows_ltsc2025_x64</span><span class=p>:</span><span class=n>v77240728</span><span class=p>-</span><span class=n>510448c3</span> <span class=n>powershell</span> <span class=n>-C</span> <span class=s2>&quot;c:\mnt\tasks\winbuildscripts\Build-AgentPackages.ps1 -BuildOutOfSource 1 -InstallDeps 1 -CheckGoVersion 1&quot;</span>
</span></code></pre></div> </div> <p>If the build succeeds, the build artifacts can be found under <code>omnibus\pkg</code> in the repo.</p> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title="Last update"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">October 9, 2025</span> </span> </aside> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../standalone/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Standalone agents"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> Standalone agents </div> </div> </a> <a href=../../test/unit/ class="md-footer__link md-footer__link--next" aria-label="Next: Unit tests"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> Unit tests </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; Datadog, Inc. 2024-present </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://www.datadoghq.com/blog/engineering/ target=_blank rel=noopener title=www.datadoghq.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M224 24c0-13.3 10.7-24 24-24 145.8 0 264 118.2 264 264 0 13.3-10.7 24-24 24s-24-10.7-24-24c0-119.3-96.7-216-216-216-13.3 0-24-10.7-24-24M80 96c26.5 0 48 21.5 48 48v224c0 26.5 21.5 48 48 48s48-21.5 48-48-21.5-48-48-48c-8.8 0-16-7.2-16-16v-64c0-8.8 7.2-16 16-16 79.5 0 144 64.5 144 144s-64.5 144-144 144S32 447.5 32 368V144c0-26.5 21.5-48 48-48m168 0c92.8 0 168 75.2 168 168 0 13.3-10.7 24-24 24s-24-10.7-24-24c0-66.3-53.7-120-120-120-13.3 0-24-10.7-24-24s10.7-24 24-24"/></svg> </a> <a href=https://github.com/DataDog target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M202.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M496 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg> </a> <a href=https://twitter.com/datadoghq target=_blank rel=noopener title=twitter.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M459.4 151.7c.3 4.5.3 9.1.3 13.6 0 138.7-105.6 298.6-298.6 298.6-59.5 0-114.7-17.2-161.1-47.1 8.4 1 16.6 1.3 25.3 1.3 49.1 0 94.2-16.6 130.3-44.8-46.1-1-84.8-31.2-98.1-72.8 6.5 1 13 1.6 19.8 1.6 9.4 0 18.8-1.3 27.6-3.6-48.1-9.7-84.1-52-84.1-103v-1.3c14 7.8 30.2 12.7 47.4 13.3-28.3-18.8-46.8-51-46.8-87.4 0-19.5 5.2-37.4 14.3-53C87.4 130.8 165 172.4 252.1 176.9c-1.6-7.8-2.6-15.9-2.6-24C249.5 95.1 296.3 48 354.4 48c30.2 0 57.5 12.7 76.7 33.1 23.7-4.5 46.5-13.3 66.6-25.3-7.8 24.4-24.4 44.8-46.1 57.8 21.1-2.3 41.6-8.1 60.4-16.2-14.3 20.8-32.2 39.3-52.6 54.3"/></svg> </a> <a href=https://www.instagram.com/datadoghq target=_blank rel=noopener title=www.instagram.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M224.3 141a115 115 0 1 0-.6 230 115 115 0 1 0 .6-230m-.6 40.4a74.6 74.6 0 1 1 .6 149.2 74.6 74.6 0 1 1-.6-149.2m93.4-45.1a26.8 26.8 0 1 1 53.6 0 26.8 26.8 0 1 1-53.6 0m129.7 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8M399 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../..", "features": ["content.action.edit", "content.code.copy", "content.tabs.link", "content.tooltips", "navigation.expand", "navigation.footer", "navigation.indexes", "navigation.instant", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky"], "search": "../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=../../../assets/javascripts/bundle.f55a23d4.min.js></script> <script id=init-glightbox>const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body> </html>