go_sdk = use_extension("@rules_go//go:extensions.bzl", "go_sdk")
go_sdk.from_file(go_work = "//:go.work")
# go_sdk.nogo(nogo = "//:nogo")  # TODO(agent-build): assess benefits of the `nogo` static code analyzer

go_deps = use_extension("@gazelle//:extensions.bzl", "go_deps")

# TODO(agent-build): remove `internal/tools/modparser` (`//:go.mod` remains) when all in-repo Go sync scripts execute:
# 1. bazel run //:go mod tidy  # updates `go.mod` (wouldn't be needed in "full" gazelle bzlmod)
# 2. bazel mod tidy            # updates `use_repo` directives
# 3. bazel run //:gazelle      # regenerates `BUILD.bazel` files
go_deps.from_file(go_mod = "//internal/tools/modparser:go.mod")
# TODO(agent-build): remove ^ and uncomment v when all Go modules are migrated
# go_deps.from_file(go_work = "//:go.work")

use_repo(
    go_deps,
    "com_github_stretchr_testify",
    "org_golang_x_mod",
)
