From af72bc8c79be86e14b3b46bd1207c23365c988d7 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Hugo=20Beauz=C3=A9e-Luyssen?= <hugo.beauzee@datadoghq.com>
Date: Thu, 27 Nov 2025 13:57:04 +0100
Subject: [PATCH] include out_data_dirs to the output groups

---
 foreign_cc/private/framework.bzl | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/foreign_cc/private/framework.bzl b/foreign_cc/private/framework.bzl
index eb7632d..fd354b7 100644
--- a/foreign_cc/private/framework.bzl
+++ b/foreign_cc/private/framework.bzl
@@ -598,7 +598,8 @@ def cc_external_rule_impl(ctx, attrs):
         outputs.libraries.static_libraries +
         outputs.libraries.shared_libraries +
         ([outputs.out_include_dir] if outputs.out_include_dir else []) +
-        ([outputs.out_pc_dir] if outputs.out_pc_dir else [])
+        ([outputs.out_pc_dir] if outputs.out_pc_dir else []) +
+        (outputs.data_dirs if outputs.data_dirs else [])
     )
     output_groups = _declare_output_groups(installdir_copy.file, output_groups)
     wrapped_files = [
@@ -849,6 +850,7 @@ _Outputs = provider(
         out_binary_files = "Binary files, which will be created by the action",
         libraries = "Library files, which will be created by the action",
         out_pc_dir = "Directory with pkgconfig files (relative to install directory)",
+        data_dirs = "Directory containing additional files generated by the build",
         declared_outputs = "All output files and directories of the action",
     ),
 )
@@ -913,6 +915,7 @@ def _define_outputs(ctx, attrs, lib_name):
         out_binary_files = out_binary_files,
         libraries = libraries,
         out_pc_dir = out_pc_dir,
+        data_dirs = out_data_dirs,
         declared_outputs = declared_outputs,
     )
 
-- 
2.43.0

