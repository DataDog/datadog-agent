%%{init: {'theme': 'base', 'themeVariables': { 'primaryColor': '#774aa4', 'primaryTextColor': '#fff', 'primaryBorderColor': '#5a3a7e', 'lineColor': '#632ca6', 'secondaryColor': '#f5f5f5', 'tertiaryColor': '#e8e8e8'}}}%%
flowchart TB
    subgraph OS["Operating System Service Manager<br/>(systemd / launchd / SCM / kubelet)"]
    end

    OS --> CoreAgent
    OS --> TraceAgent
    OS --> ProcessAgent
    OS --> SecurityAgent
    OS --> SystemProbe

    subgraph CoreAgent["Core Agent"]
    end

    subgraph TraceAgent["Trace Agent"]
    end

    subgraph ProcessAgent["Process Agent"]
    end

    subgraph SecurityAgent["Security Agent"]
    end

    subgraph SystemProbe["System Probe"]
    end

    classDef osManager fill:#774aa4,stroke:#5a3a7e,color:#fff
    classDef agent fill:#632ca6,stroke:#4a1f80,color:#fff

    class OS osManager
    class CoreAgent,TraceAgent,ProcessAgent,SecurityAgent,SystemProbe agent



